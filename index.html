<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Reflective-FG&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Reflective-FG&#039;s Blog"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Reflective-FG&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Fantasyn"><meta property="og:type" content="blog"><meta property="og:title" content="Reflective-FG&#039;s Blog"><meta property="og:url" content="http://example.com/"><meta property="og:site_name" content="Reflective-FG&#039;s Blog"><meta property="og:description" content="Fantasyn"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:author" content="Reflective-FG"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com"},"headline":"Reflective-FG's Blog","image":["http://example.com/img/og_image.png"],"author":{"@type":"Person","name":"Reflective-FG"},"publisher":{"@type":"Organization","name":"Reflective-FG's Blog","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":"Fantasyn"}</script><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Reflective-FG&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item is-active" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/%E6%96%AF%E6%B6%85%E5%B0%94%E5%AE%9A%E5%BE%8B%E6%9C%80%E6%84%9A%E8%A0%A2%E7%9A%84%E8%AF%81%E6%B3%95/"><img class="fill" src="https://pic.imgdb.cn/item/63ae2ef408b6830163989977.jpg" alt="斯涅尔定律最愚蠢的证法"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.697Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:51:01.756Z" title="2023/1/3 10:51:01">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a></span><span class="level-item">2 分钟读完 (大约345个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/%E6%96%AF%E6%B6%85%E5%B0%94%E5%AE%9A%E5%BE%8B%E6%9C%80%E6%84%9A%E8%A0%A2%E7%9A%84%E8%AF%81%E6%B3%95/">斯涅尔定律最愚蠢的证法</a></h1><div class="content"><p>2022 年整的最后一个活。</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>平面直角坐标系上有两点 $S(0,h_1)$ 和 $T(w,h_2)$ 满足 $h_1&gt;0,h_2&lt;0$，一个动点 $P$ 从 $S$ 出发移动到 $T$。$P$ 在 $x$ 轴上方时的速度为 $v_1$，在 $x$ 轴下方时的速度为 $v_2$，求时间最短的路径。</p>
<p><img src="https://pic.imgdb.cn/item/63ae250608b683016390b61d.jpg"></p>
<p>斯涅尔定律：$\dfrac{\sin(\theta_1)}{v_1}&#x3D;\dfrac{\sin(\theta_2)}{v_2}$</p>
<h2 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h2><p>显然，路径为两条线段组成的折线，转折点在 $x$ 轴上。</p>
<p>设折线与 $x$ 轴交点位于 $(0,x)$。</p>
<p><img src="https://pic.imgdb.cn/item/63ae2e2e08b683016397f915.jpg"></p>
<p>容易得出路径长度的函数 $f(x)$：<br>$$f(x)&#x3D;\dfrac{\sqrt{h_1^2+x^2}}{v}+\dfrac{\sqrt{h_2^2+(w-x)^2}}{v2}$$</p>
<p>当取 $h_1&#x3D;3,h_2&#x3D;5,w&#x3D;10,v_1&#x3D;3,v_2&#x3D;1$ 时，函数图像长这个样子：</p>
<p><img src="https://pic.imgdb.cn/item/63ae298008b683016394040a.jpg"></p>
<p>发现它是一个单谷函数，它的最小值就是唯一的极小值。所以求导：</p>
<p>$$f’(x)&#x3D;\dfrac{v_2x\sqrt{(w-x)^2+h_2^2}-v_1(w-x)\sqrt{x^2+h_1^2}}{v_1v_2\sqrt{x^2+h_1^2}\sqrt{(w-x)^2+h_2^2}}$$</p>
<p>最小值点的导数为 $0$，所以得出：</p>
<p>$$v_2x\sqrt{(w-x)^2+h_2^2}&#x3D;v_1(w-x)\sqrt{x^2+h_1^2}$$</p>
<p>$$\dfrac{x\sqrt{(w-x)^2+h_2^2}}{(w-x)\sqrt{x^2+h_1^2}}&#x3D;\dfrac{v_1}{v_2}$$</p>
<p>$$\dfrac{x}{\sqrt{x^2+h_1^2}}:\dfrac{w-x}{\sqrt{(w-x)^2+h_2^2}}&#x3D;v_1:v_2$$</p>
<p><img src="https://pic.imgdb.cn/item/63ae2ef408b6830163989977.jpg"></p>
<p>$$\dfrac{SP}{SM}:\dfrac{QT}{MT}&#x3D;v_1:v_2$$</p>
<p>$$\dfrac{\sin(\theta_1)}{v_1}&#x3D;\dfrac{\sin(\theta_2)}{v_2}$$</p>
<p>证毕。</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F2022%E5%88%9D%E8%B5%9B%E6%B8%B8%E8%AE%B0/"><img class="fill" src="https://pic.imgdb.cn/item/63b385fabe43e0d30e3caecb.jpg" alt="百度之星2022初赛游记"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.697Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:51:10.026Z" title="2023/1/3 10:51:10">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="level-item">19 分钟读完 (大约2910个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F2022%E5%88%9D%E8%B5%9B%E6%B8%B8%E8%AE%B0/">百度之星2022初赛游记</a></h1><div class="content"><p>做的是第二场。</p>
<p>看别人打的第一场做了 7 题还 100+ 名，一开题感觉一道都不会做，很慌。</p>
<p>最后做出来 5 题，66 名，很开心。</p>
<p>做题顺序：$1\rightarrow 3 \rightarrow 7 \rightarrow 5 \rightarrow 4$</p>
<p>这场显然偶数题比奇数题难。</p>
<h2 id="1-和"><a href="#1-和" class="headerlink" title="1. 和"></a>1. 和</h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>给定一个长为 $n$ 的序列，有 $q$ 次询问，每次询问 $[l,r]$ 区间内最大的 $k$ 个数之和是否 $\ge x$。</p>
<p>$n,q \le 10^5,k\le 10,a_i \le 10^4,x\le 10^8$</p>
<h3 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h3><p>第一遍写了莫队，用 set 维护，显而易见 TLE 了。（不过这个我还写了好久 &#x2F;lh）</p>
<p>由于 $k$ 十分小，所以用线段树维护区间内前 $k$ 小的值，合并什么的总之就是非常暴力。</p>
<p>复杂度 $O(nk \log k+qk\log nk)$。</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i, n) forr(i, 0, n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i, n) forr(i, 1, n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a, i) memset(a, i, sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ls node*2+1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rs node*2+2</span></span><br><span class="line"><span class="type">int</span> T_ = <span class="number">1</span>, case_;</span><br><span class="line"><span class="type">int</span> a[<span class="number">100005</span>];</span><br><span class="line"><span class="type">int</span> n, q, k, x;</span><br><span class="line"><span class="type">int</span> tree[<span class="number">400005</span>][<span class="number">21</span>], cnt[<span class="number">400005</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">build</span><span class="params">(<span class="type">int</span> node, <span class="type">int</span> l, <span class="type">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l == r) &#123;</span><br><span class="line">        cnt[node] = <span class="number">1</span>;</span><br><span class="line">        tree[node][<span class="number">0</span>] = a[l];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(ls, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(rs, mid + <span class="number">1</span>, r);</span><br><span class="line">    cnt[node] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i, cnt[ls])tree[node][cnt[node]++] = tree[ls][i];</span><br><span class="line">    <span class="built_in">rep</span>(i, cnt[rs])tree[node][cnt[node]++] = tree[rs][i];</span><br><span class="line">    <span class="built_in">sort</span>(tree[node], tree[node] + cnt[node]);</span><br><span class="line">    <span class="built_in">reverse</span>(tree[node], tree[node] + cnt[node]);</span><br><span class="line">    cnt[node] = <span class="built_in">min</span>(cnt[node], k);</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;ans;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">query</span><span class="params">(<span class="type">int</span> node, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> L, <span class="type">int</span> R)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class="line">        <span class="built_in">rep</span>(i, cnt[node])ans.<span class="built_in">pb</span>(tree[node][i]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (mid &gt;= L)<span class="built_in">query</span>(ls, l, mid, L, R);</span><br><span class="line">    <span class="keyword">if</span> (mid &lt; R)<span class="built_in">query</span>(rs, mid + <span class="number">1</span>, r, L, R);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> l, r, sum;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; q &gt;&gt; k &gt;&gt; x;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)cin &gt;&gt; a[i];</span><br><span class="line">    <span class="built_in">build</span>(<span class="number">0</span>, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">        ans.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">query</span>(<span class="number">0</span>, <span class="number">0</span>, n - <span class="number">1</span>, l - <span class="number">1</span>, r - <span class="number">1</span>);</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">sort</span>(ans.<span class="built_in">begin</span>(), ans.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">reverse</span>(ans.<span class="built_in">begin</span>(), ans.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="built_in">min</span>((<span class="type">int</span>)ans.<span class="built_in">size</span>(), k))sum += ans[i];</span><br><span class="line">        <span class="keyword">if</span> (sum &gt;= x)cout &lt;&lt; <span class="string">&quot;Y\n&quot;</span>;</span><br><span class="line">        <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;N\n&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ios::sync_with_stdio(0);</span></span><br><span class="line">    <span class="comment">// cin.tie(0), cout.tie(0);</span></span><br><span class="line">    <span class="comment">// cin &gt;&gt; T_;</span></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>; case_ &lt;= T_; case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="3-逃离这棵树"><a href="#3-逃离这棵树" class="headerlink" title="3. 逃离这棵树"></a>3. 逃离这棵树</h2><h3 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h3><p>给定一棵大小为 $n$ 的树，根节点为 $1$，每个点有权重 $p_i$，$i$ 到 $j$ 的边有权重 $q_{i,j}$。</p>
<p>当站在点 $i$ 上时，下一步有 $\frac{p_i}{p_i+\sum q_{i,j}}$ 的概率留在原地，有 $\frac{q_{i,j}}{p_i+\sum q_{i,j}}$ 的概率到 $j$ 节点（$j$ 为 $i$ 的儿子）。</p>
<p>初始时在根节点，问期望多少步后到达叶节点，对 $998244353$ 取模。</p>
<p>$n \le 10^6,p_i,q_{i,j}\le 10$</p>
<h3 id="做法-1"><a href="#做法-1" class="headerlink" title="做法"></a>做法</h3><p>做法类似于某场 ABC 的 E 题，只是把数轴换成了树。然而我至今没有补掉那个题，但是赛时把这个题切了。</p>
<p>设 $dp_i$ 为 $i$ 期望走多少步到叶节点。</p>
<p>考虑枚举从 $i$ 下一步到达的点 $j$，$j$ 对 $i$ 的答案的贡献是 $\frac{q_{i,j}}{p_i+\sum q_{i,j}} \cdot dp_j$。</p>
<p>另外，$i$ 节点期望要 $\frac{p_i+\sum q_{i,j}}{p_i}$ 步离开原地，所以 $dp_i$ 还要再加上这个数。</p>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i, n) forr(i, 0, n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i, n) forr(i, 1, n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a, i) memset(a, i, sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="type">int</span> T_ = <span class="number">1</span>, case_;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> MOD = <span class="number">998244353</span>;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll x, ll y)</span> </span>&#123;</span><br><span class="line">    ll p = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (y) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>)p = p * x % MOD;</span><br><span class="line">        x = x * x % MOD;</span><br><span class="line">        y &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll x)</span> </span>&#123; <span class="keyword">return</span> <span class="built_in">qpow</span>(x, MOD - <span class="number">2</span>); &#125;</span><br><span class="line"><span class="type">int</span> n, p[<span class="number">1000006</span>], q[<span class="number">1000006</span>];</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;v;</span><br><span class="line">ll dp[<span class="number">1000006</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (v[x].<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        dp[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> y : v[x]) &#123;</span><br><span class="line">        <span class="built_in">dfs</span>(y);</span><br><span class="line">        sum += q[y];</span><br><span class="line">    &#125;</span><br><span class="line">    ll INV = <span class="built_in">inv</span>(sum);</span><br><span class="line">    dp[x] = (sum + p[x]) * INV;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> y : v[x])dp[x] = (dp[x] + q[y] * INV % MOD * dp[y] % MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">rep</span>(i, n) cin &gt;&gt; p[i];</span><br><span class="line">    v.<span class="built_in">resize</span>(n);</span><br><span class="line">    <span class="built_in">repp</span>(i, n - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="type">int</span> a;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; q[i];</span><br><span class="line">        v[a - <span class="number">1</span>].<span class="built_in">pb</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">    cout &lt;&lt; dp[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ios::sync_with_stdio(0);</span></span><br><span class="line">    <span class="comment">// cin.tie(0), cout.tie(0);</span></span><br><span class="line">    <span class="comment">// cin &gt;&gt; T_;</span></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>; case_ &lt;= T_; case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-通信网络"><a href="#4-通信网络" class="headerlink" title="4. 通信网络"></a>4. 通信网络</h2><h3 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h3><p>给定一个 $n$ 个点，$m$ 条边的无向图，一条边 $(u,v,w)$ 表示这条边连接 $u$ 和 $v$，长度为 $w$。有 $q$ 次询问，每次询问给定 $k$ 个关键点，第 $i$ 个关键点为 $p_i$，与这个点的距离 $\le d_i$ 的节点会被打上标记。对于每次询问，输出有多少个点被打上了标记。询问之间独立，也就是每次打上的标记会在下一次询问前清空。</p>
<p>$n \le 10^3,m \le 10^4,q \le 10^5,\sum k \le 10^6,w \le 10^6,d_i \le 10^9$</p>
<h3 id="做法-2"><a href="#做法-2" class="headerlink" title="做法"></a>做法</h3><p>把询问离线下来，对于每个关键点分别处理。</p>
<p>对于每个询问一个 bitset $ans_i$，$ans_{i,j}$ 表示在第 $i$ 次询问中，$j$ 是否被打上了标记。</p>
<p>对于每个关键点 $x$，把和它有关的询问按照 $d$ 从小到大排序。</p>
<p>维护一个 bitset $res$，$res_i$ 表示 $i$ 与 $x$ 的距离是否 $\le d$。容易发现，由于 $d$ 已经从小到大排序过了，所以 $res$ 中的元素只会从 $0$ 变成 $1$，或者不变。</p>
<p>所以先跑一边 dijkstra，处理出所有点到 $x$ 的距离，然后把所有点按照与 $x$ 的距离排序，单调地往 $res$ 中加入就可以了。处理到第 $i$ 个询问时，把 $ans_i$ 按位或上 $res$，最后答案就是 $ans_i.count()$。</p>
<p>复杂度 $O(n^2\log n+nm \log m+k \log k+\frac{nk}{\omega})$，能过。</p>
<h3 id="代码-2"><a href="#代码-2" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i, n) forr(i, 0, n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i, n) forr(i, 1, n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a, i) memset(a, i, sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="type">int</span> T_ = <span class="number">1</span>, case_;</span><br><span class="line"><span class="type">int</span> n, m, q, a, b, c;</span><br><span class="line"><span class="type">int</span> dist[<span class="number">1010</span>];</span><br><span class="line"><span class="type">int</span> k;</span><br><span class="line">vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;g[<span class="number">1010</span>], v[<span class="number">1010</span>];</span><br><span class="line">bitset&lt;1010&gt;ans[<span class="number">100005</span>], tmp;</span><br><span class="line">priority_queue&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;pq;</span><br><span class="line"><span class="type">int</span> id[<span class="number">1010</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;</span><br><span class="line">    <span class="built_in">rep</span>(i, m) &#123;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">        a--, b--;</span><br><span class="line">        g[a].<span class="built_in">pb</span>(<span class="built_in">mp</span>(b, c));</span><br><span class="line">        g[b].<span class="built_in">pb</span>(<span class="built_in">mp</span>(a, c));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">rep</span>(i, q) &#123;</span><br><span class="line">        cin &gt;&gt; k;</span><br><span class="line">        <span class="built_in">rep</span>(j, k) &#123;</span><br><span class="line">            cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">            v[a - <span class="number">1</span>].<span class="built_in">pb</span>(<span class="built_in">mp</span>(b, i));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">rep</span>(i, n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (v[i].<span class="built_in">empty</span>())<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">init</span>(dist, <span class="number">63</span>);</span><br><span class="line">        dist[i] = <span class="number">0</span>;</span><br><span class="line">        pq.<span class="built_in">push</span>(<span class="built_in">mp</span>(<span class="number">0</span>, i));</span><br><span class="line">        <span class="keyword">while</span> (!pq.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="type">int</span> val = -pq.<span class="built_in">top</span>().fi, x = pq.<span class="built_in">top</span>().se;</span><br><span class="line">            pq.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span> (val != dist[x])<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (g[x].<span class="built_in">size</span>())<span class="built_in">rep</span>(j, g[x].<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="type">int</span> y = g[x][j].fi, w = g[x][j].se;</span><br><span class="line">                <span class="keyword">if</span> (dist[y] &gt; val + w) &#123;</span><br><span class="line">                    dist[y] = val + w;</span><br><span class="line">                    pq.<span class="built_in">push</span>(<span class="built_in">mp</span>(-dist[y], y));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp.<span class="built_in">reset</span>();</span><br><span class="line">        <span class="built_in">rep</span>(i, n)id[i] = i;</span><br><span class="line">        <span class="built_in">sort</span>(id, id + n, [&amp;](<span class="type">int</span> x, <span class="type">int</span> y) &#123;<span class="keyword">return</span> dist[x] &lt; dist[y];&#125;);</span><br><span class="line">        <span class="built_in">sort</span>(v[i].<span class="built_in">begin</span>(), v[i].<span class="built_in">end</span>());</span><br><span class="line">        <span class="type">int</span> p = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">rep</span>(j, v[i].<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="keyword">while</span> (p &lt; n &amp;&amp; dist[id[p]] &lt;= v[i][j].fi) &#123;</span><br><span class="line">                tmp[id[p]] = <span class="number">1</span>;</span><br><span class="line">                p++;</span><br><span class="line">            &#125;</span><br><span class="line">            ans[v[i][j].se] |= tmp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">rep</span>(i, q)cout &lt;&lt; ans[i].<span class="built_in">count</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ios::sync_with_stdio(0);</span></span><br><span class="line">    <span class="comment">// cin.tie(0), cout.tie(0);</span></span><br><span class="line">    <span class="comment">// cin &gt;&gt; T_;</span></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>; case_ &lt;= T_; case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="5-星球联通"><a href="#5-星球联通" class="headerlink" title="5. 星球联通"></a>5. 星球联通</h2><h3 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h3><p>给定三维空间内的 $n$ 个点，表示一个点的坐标为 $(x,y,z)$，连接两个点的代价是它们距离的平方。</p>
<p>现在可以免费连接 $k$ 个点，额外再连接 $i$ 个点（即一共连接 $k+i$ 个点）需要花 $c_i$ 的代价。</p>
<p>求将所有点连通起来的最小代价。</p>
<p>$k \le n \le 3000,c_i \le 10^9,x,y,z \le 10^4$</p>
<h3 id="做法-3"><a href="#做法-3" class="headerlink" title="做法"></a>做法</h3><p>显然枚举额外连接多少个星球，现在问题变成：</p>
<blockquote>
<p>给定一张带权完全图，连接其中 $x$ 个点，代价最少是多少。</p>
</blockquote>
<p>容易联想到最小生成树的 Kruskal 算法。改一下：</p>
<p>把边按边权从小到大依次检查，如果连接的两个点不在同一个连通分量里，就把这条边加进去。当有 $x-1$ 条边时结束。</p>
<p>这个看上去就很对的算法实际上也是对的，正确性易证，但是我不会证，大概和 Kruskal 的证法差不多。</p>
<h3 id="代码-3"><a href="#代码-3" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i, n) forr(i, 0, n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i, n) forr(i, 1, n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a, i) memset(a, i, sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f3f3f3f3f</span></span><br><span class="line"><span class="type">int</span> T_ = <span class="number">1</span>, case_;</span><br><span class="line">ll n, k, c[<span class="number">3010</span>], x[<span class="number">3010</span>], y[<span class="number">3010</span>], z[<span class="number">3010</span>], ans, sum, cnt;</span><br><span class="line">vector &lt; pair&lt;ll, pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt;&gt;&gt;v;</span><br><span class="line"><span class="type">int</span> fa[<span class="number">3010</span>];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">getf</span><span class="params">(<span class="type">int</span> i)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (fa[i] == i)<span class="keyword">return</span> i;</span><br><span class="line">    <span class="keyword">return</span> fa[i] = <span class="built_in">getf</span>(fa[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="built_in">repp</span>(i, n - k)cin &gt;&gt; c[i];</span><br><span class="line">    <span class="built_in">rep</span>(i, n)cin &gt;&gt; x[i] &gt;&gt; y[i] &gt;&gt; z[i];</span><br><span class="line">    <span class="built_in">rep</span>(i, n)forr(j, i + <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">        ll X = x[i] - x[j], Y = y[i] - y[j], Z = z[i] - z[j];</span><br><span class="line">        ll val = X * X + Y * Y + Z * Z;</span><br><span class="line">        v.<span class="built_in">pb</span>(<span class="built_in">mp</span>(val, <span class="built_in">mp</span>(i, j)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>());</span><br><span class="line">    <span class="built_in">rep</span>(i, n)fa[i] = i;</span><br><span class="line">    ans = c[n - k], sum = <span class="number">0</span>, cnt = n - k;</span><br><span class="line">    <span class="built_in">rep</span>(i, v.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> a = v[i].se.fi, b = v[i].se.se;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">getf</span>(a) == <span class="built_in">getf</span>(b))<span class="keyword">continue</span>;</span><br><span class="line">        cnt--;</span><br><span class="line">        fa[<span class="built_in">getf</span>(a)] = <span class="built_in">getf</span>(b);</span><br><span class="line">        sum += v[i].fi;</span><br><span class="line">        ans = <span class="built_in">min</span>(ans, sum + c[cnt]);</span><br><span class="line">        <span class="keyword">if</span> (!cnt)<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ios::sync_with_stdio(0);</span></span><br><span class="line">    <span class="comment">// cin.tie(0), cout.tie(0);</span></span><br><span class="line">    <span class="comment">// cin &gt;&gt; T_;</span></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>; case_ &lt;= T_; case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-原地传送"><a href="#7-原地传送" class="headerlink" title="7. 原地传送"></a>7. 原地传送</h2><h3 id="题意-4"><a href="#题意-4" class="headerlink" title="题意"></a>题意</h3><p>有一个 $n\times m$ 的网格图，起点为 $(0,0)$，终点为 $(n,m)$，每次可以从 $(x,y)$ 走到 $(x+1,y)$ 或 $(x,y+1)$。</p>
<p>有 $k$ 个传送门，第 $i$ 个传送门在 $(x_i,y_i)$，碰到传送门就必须要立即移动到另一个传送门（不能原地传送）。</p>
<p>求有多少种恰好传送一次后到达终点的行走方案。</p>
<p>$n,m \le 10^5,k \le 2000$</p>
<h3 id="做法-4"><a href="#做法-4" class="headerlink" title="做法"></a>做法</h3><p>枚举传送的起点和终点是哪两个传送门，问题转化成：</p>
<blockquote>
<p>有多少种方法从起点走到传送门 $i$ &#x2F; 从传送门 $i$ 走到终点，中途不碰到任何其它的传送门。</p>
</blockquote>
<p>考虑从起点走到传送门 $i$ 的情况，另一种同理。</p>
<p>设 $i$ 的答案是 $dp_i$，$cnt(a,b)$ 表示向 $x$ 方向走 $a$ 步，向 $y$ 方向走 $b$ 步的方案数。</p>
<p>易得 $cnt(a,b)&#x3D;\binom{a+b}{a}$。</p>
<p>如果不考虑 “中途不碰到任何其它的传送门” 这一条件，那么 $dp_i&#x3D;cnt(x_i,y_i)$。</p>
<p>枚举第一个碰到的传送门 $j$，从起点走到 $j$ （中途不碰到任何其它的传送门）有 $dp_j$ 种方案，从 $j$ 走到 $i$（因为已经确定了第一个碰到的，所以后面就没有限制条件了）有 $cnt(x_i-x_j,y_i-y_j)$ 种方案，所以 $dp_i$ 要减去 $dp_j \cdot cnt(x_i-x_j,y_i-y_j)$。</p>
<p>然后发现只有在 $x_j\le x_i$ 且 $y_j \le y_i$ 时这个转移才有效，所以把所有坐标按照 $x+y$ 从小到大排序，计算 $dp_i$ 时只要考虑所有 $j&lt;i$。</p>
<p>复杂度 $O(n^2)$。</p>
<h3 id="代码-4"><a href="#代码-4" class="headerlink" title="代码"></a>代码</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i, n) forr(i, 0, n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i, n) forr(i, 1, n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a, i) memset(a, i, sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="type">int</span> T_ = <span class="number">1</span>, case_;</span><br><span class="line"><span class="type">int</span> n, m, r, c, a[<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;v;</span><br><span class="line"><span class="type">int</span> cost1[<span class="number">20</span>][<span class="number">20</span>], cost2[<span class="number">20</span>], dp[<span class="number">20</span>][<span class="number">20</span>], ans = MAXN;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m &gt;&gt; r &gt;&gt; c;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)<span class="built_in">rep</span>(j, m)cin &gt;&gt; a[i][j];</span><br><span class="line">    <span class="built_in">repp</span>(w, (<span class="number">1</span> &lt;&lt; m) - <span class="number">1</span>) &#123;</span><br><span class="line">        v.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">rep</span>(i, m)<span class="keyword">if</span> ((w &gt;&gt; i) &amp; <span class="number">1</span>)v.<span class="built_in">pb</span>(i);</span><br><span class="line">        <span class="keyword">if</span> ((<span class="type">int</span>)v.<span class="built_in">size</span>() != c)<span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i, n)forr(j, i + <span class="number">1</span>, n - <span class="number">1</span>) &#123;</span><br><span class="line">            cost1[i][j] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">rep</span>(k, c)cost1[i][j] += <span class="built_in">abs</span>(a[i][v[k]] - a[j][v[k]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">rep</span>(i, n) &#123;</span><br><span class="line">            cost2[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">rep</span>(j, c - <span class="number">1</span>)cost2[i] += <span class="built_in">abs</span>(a[i][v[j]] - a[i][v[j + <span class="number">1</span>]]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">init</span>(dp, <span class="number">63</span>);</span><br><span class="line">        <span class="built_in">rep</span>(i, n) &#123;</span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="number">0</span>, dp[i][<span class="number">1</span>] = cost2[i];</span><br><span class="line">            forr(j, <span class="number">2</span>, i + <span class="number">1</span>)<span class="built_in">rep</span>(k, i)dp[i][j] = <span class="built_in">min</span>(dp[i][j], dp[k][j - <span class="number">1</span>] + cost1[k][i] + cost2[i]);</span><br><span class="line">            ans = <span class="built_in">min</span>(ans, dp[i][r]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// ios::sync_with_stdio(0);</span></span><br><span class="line">    <span class="comment">// cin.tie(0), cout.tie(0);</span></span><br><span class="line">    <span class="comment">// cin &gt;&gt; T_;</span></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>; case_ &lt;= T_; case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="写在最后"><a href="#写在最后" class="headerlink" title="写在最后"></a>写在最后</h2><p>感觉这场比赛都是第一眼很吓人，仔细想想其实还好的题。</p>
<p>大家来了应该都能爆切吧。</p>
<p>QwQ</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/%E4%B8%80%E4%BA%9B%20trick/"><img class="fill" src="https://pic.imgdb.cn/item/63b38fcabe43e0d30e48ef5b.jpg" alt="一些 trick"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.695Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:50:57.852Z" title="2023/1/3 10:50:57">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span><span class="level-item">1 分钟读完 (大约165个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/%E4%B8%80%E4%BA%9B%20trick/">一些 trick</a></h1><div class="content"><h2 id="枚举子集"><a href="#枚举子集" class="headerlink" title="枚举子集"></a>枚举子集</h2><p>枚举 $i$ 在二进制下的的所有子集 $j$（即 $i &amp; j&#x3D;j$）</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=i;;j=(j<span class="number">-1</span>)&amp;i)&#123;</span><br><span class="line">    <span class="comment">// something here</span></span><br><span class="line">    <span class="keyword">if</span>(!j)<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>顺便说一下，$\sum\limits_{i&#x3D;1}^{2^n}2^{\operatorname{popcount}(i)}&#x3D;O(3^n)$</p>
<h2 id="splay-求-x-节点的-rk"><a href="#splay-求-x-节点的-rk" class="headerlink" title="splay 求 x 节点的 rk"></a>splay 求 x 节点的 rk</h2><p>有时 val 不满足 $左&lt;根&lt;右$ 时（比如文艺平衡树），无法正常实现 rk</p>
<p>可以先把 x splay 至根，然后求根的左子树 siz</p>
<p>注意树上有标记时要先把 x 的祖先按深度从小到大顺序 pushdown tag</p>
<h2 id="区间覆盖-dp"><a href="#区间覆盖-dp" class="headerlink" title="区间覆盖 dp"></a>区间覆盖 dp</h2><p>每个区间转成两个端点处的差分（l+1,(r+1)-1），记录当前的前缀和 dp。</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/UVA1063-Marble-Game/"><img class="fill" src="https://pic.imgdb.cn/item/63b382b7be43e0d30e389fd0.jpg" alt="UVA1063 Marble Game"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.692Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:51:14.779Z" title="2023/1/3 10:51:14">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="level-item">7 分钟读完 (大约978个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/UVA1063-Marble-Game/">UVA1063 Marble Game</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://onlinejudge.org/external/10/p1063.pdf">题目传送门</a></p>
<p>说是题解其实是 debug 记（叹气）</p>
<p>显然 BFS，状态我是用 <code>vector&lt;vector&lt;int&gt;&gt;</code> 来存每个格子上的 Marble 编号，洞可以根据这个推出来，就不用存。</p>
<p>转移时，枚举向四个方向移动。这里写四个函数可能会比较烦，我的做法是，对于 $n\in [0,4]$，先将盘面顺时针转 $n\cdot 90^\circ$，再将所有 Marble 向左移动，最后将盘面顺时针旋转 $(4-n)\cdot 90^\circ$。</p>
<p>注意：</p>
<ul>
<li>旋转时，Marble，洞和墙都要旋转。</li>
<li>移动时，如果 Marble 掉进了对应的洞里，就把这个 Marble 和洞都删掉，如果掉进了别人的洞里，就不进行这个方向的转移。</li>
<li>输出格式，<code>impossible</code> 首字母小写，如果答案是 1 仍然是 <code>moves</code> 而不是 <code>move</code>。</li>
</ul>
<p>然后，我就 WA 啦。</p>
<p>找 gzy 的程序对拍了下，放一下生成数据的代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a[<span class="number">5</span>][<span class="number">5</span>], b[<span class="number">5</span>][<span class="number">5</span>], cnt;</span><br><span class="line"><span class="type">int</span> x[<span class="number">16</span>];</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">T</span>&gt;</span><br><span class="line"><span class="function">T <span class="title">randint</span><span class="params">(T l, T r = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="type">static</span> mt19937 <span class="title">eng</span><span class="params">(time(<span class="number">0</span>))</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">        <span class="built_in">swap</span>(l, r);</span><br><span class="line">    <span class="function">uniform_int_distribution&lt;T&gt; <span class="title">dis</span><span class="params">(l, r)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dis</span>(eng);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> dx[] = &#123; <span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span> &#125;;</span><br><span class="line"><span class="type">int</span> dy[] = &#123; <span class="number">0</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span> &#125;;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">rep</span>(T, <span class="number">1000</span>) &#123;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">16</span>)x[i] = i;</span><br><span class="line">        <span class="built_in">random_shuffle</span>(x, x + <span class="number">16</span>);</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">4</span>)<span class="built_in">rep</span>(j, <span class="number">4</span>)a[i][j] = x[cnt++];</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">16</span>)x[i] = i;</span><br><span class="line">        <span class="built_in">random_shuffle</span>(x, x + <span class="number">16</span>);</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">4</span>)<span class="built_in">rep</span>(j, <span class="number">4</span>)b[i][j] = x[cnt++];</span><br><span class="line">        <span class="type">int</span> M = <span class="built_in">randint</span>(<span class="number">1</span>, <span class="number">8</span>), W = <span class="built_in">randint</span>(<span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line">        <span class="type">bool</span> f = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">4</span>)<span class="built_in">rep</span>(j, <span class="number">4</span>)<span class="keyword">if</span> (a[i][j] &lt; M &amp;&amp; b[i][j] &lt; M)f = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (f == <span class="number">1</span>)<span class="keyword">continue</span>;</span><br><span class="line">        cout &lt;&lt; <span class="number">4</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; M &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; W &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">rep</span>(s, M)</span><br><span class="line">            <span class="built_in">rep</span>(i, <span class="number">4</span>)<span class="built_in">rep</span>(j, <span class="number">4</span>)<span class="keyword">if</span> (a[i][j] == s)cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; j &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">rep</span>(s, M)</span><br><span class="line">            <span class="built_in">rep</span>(i, <span class="number">4</span>)<span class="built_in">rep</span>(j, <span class="number">4</span>)<span class="keyword">if</span> (b[i][j] == s)cout &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; j &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">while</span> (W--) &#123;</span><br><span class="line">            <span class="type">int</span> A = <span class="built_in">randint</span>(<span class="number">1</span>, <span class="number">2</span>), B = <span class="built_in">randint</span>(<span class="number">1</span>, <span class="number">2</span>), C = <span class="built_in">randint</span>(<span class="number">0</span>, <span class="number">3</span>);</span><br><span class="line">            cout &lt;&lt; A &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; B &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; A + dx[C] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; B + dy[C] &lt;&lt; endl;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;0 0 0\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>拍出来几个问题：</p>
<ul>
<li>输入数据中下标是从 0 开始的</li>
<li>多测记得清空</li>
<li>每次移动后，Marble 和洞都要还原成移动前的位置</li>
<li>记录每个 Marble 是否出现的数组要开至少 8 大小</li>
</ul>
<p>拍出来问题的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">Input 1</span><br><span class="line"></span><br><span class="line">4 3 7</span><br><span class="line">0 1</span><br><span class="line">2 0</span><br><span class="line">0 3</span><br><span class="line">2 1</span><br><span class="line">1 1</span><br><span class="line">3 2</span><br><span class="line">2 2 3 2</span><br><span class="line">1 2 1 3</span><br><span class="line">1 1 2 1</span><br><span class="line">2 1 2 2</span><br><span class="line">2 2 3 2</span><br><span class="line">2 2 3 2</span><br><span class="line">1 2 1 1</span><br><span class="line"></span><br><span class="line">Output 1</span><br><span class="line"></span><br><span class="line">impossible</span><br><span class="line"></span><br><span class="line">Input 2</span><br><span class="line"></span><br><span class="line">4 8 9</span><br><span class="line">0 0</span><br><span class="line">1 0</span><br><span class="line">2 0</span><br><span class="line">3 0</span><br><span class="line">3 1</span><br><span class="line">3 2</span><br><span class="line">3 3</span><br><span class="line">2 3</span><br><span class="line">1 2</span><br><span class="line">2 2</span><br><span class="line">2 1</span><br><span class="line">1 1</span><br><span class="line">0 1</span><br><span class="line">0 2</span><br><span class="line">0 3</span><br><span class="line">1 3</span><br><span class="line">0 0 0 1</span><br><span class="line">1 0 1 1</span><br><span class="line">2 0 2 1</span><br><span class="line">2 1 3 1</span><br><span class="line">2 2 3 2</span><br><span class="line">2 2 2 3</span><br><span class="line">1 2 1 3</span><br><span class="line">0 2 1 2</span><br><span class="line">1 1 1 2</span><br><span class="line"></span><br><span class="line">Output 2</span><br><span class="line"></span><br><span class="line">25 moves</span><br></pre></td></tr></table></figure>

<p>Code</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n, m, w, A, B, C, D;</span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>&lt;(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; A, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; B) &#123;</span><br><span class="line">    <span class="built_in">repp</span>(i, n)<span class="built_in">repp</span>(j, n)<span class="keyword">if</span> (A[i][j] != B[i][j])<span class="keyword">return</span> A[i][j] &lt; B[i][j];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">bool</span> <span class="keyword">operator</span>==(vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; A, vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; B) &#123;</span><br><span class="line">    <span class="built_in">repp</span>(i, n)<span class="built_in">repp</span>(j, n)<span class="keyword">if</span> (A[i][j] != B[i][j])<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;vector&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">a</span>(<span class="number">5</span>), <span class="built_in">b</span>(<span class="number">5</span>), <span class="built_in">x</span>(<span class="number">5</span>), <span class="built_in">y</span>(<span class="number">5</span>), <span class="built_in">cpy</span>(<span class="number">5</span>);</span><br><span class="line"><span class="type">bool</span> f[<span class="number">5</span>][<span class="number">5</span>][<span class="number">5</span>][<span class="number">5</span>], f_[<span class="number">5</span>][<span class="number">5</span>][<span class="number">5</span>][<span class="number">5</span>], F[<span class="number">100</span>];</span><br><span class="line">map&lt;vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;, <span class="type">int</span>&gt;vis;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> N)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (N--) &#123;</span><br><span class="line">        <span class="built_in">repp</span>(i, n)<span class="built_in">repp</span>(j, n)cpy[i][j] = x[n + <span class="number">1</span> - j][i];</span><br><span class="line">        x = cpy;</span><br><span class="line">        <span class="built_in">repp</span>(i, n)<span class="built_in">repp</span>(j, n)cpy[i][j] = y[n + <span class="number">1</span> - j][i];</span><br><span class="line">        y = cpy;</span><br><span class="line">        <span class="built_in">repp</span>(i1, n)<span class="built_in">repp</span>(j_1, n)<span class="built_in">repp</span>(i2, n)<span class="built_in">repp</span>(j2, n)f_[i1][j_1][i2][j2] = f[n + <span class="number">1</span> - j_1][i1][n + <span class="number">1</span> - j2][i2];</span><br><span class="line">        <span class="built_in">repp</span>(i1, n)<span class="built_in">repp</span>(j_1, n)<span class="built_in">repp</span>(i2, n)<span class="built_in">repp</span>(j2, n)f[i1][j_1][i2][j2] = f_[i1][j_1][i2][j2];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">move</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">repp</span>(i, n) &#123;</span><br><span class="line">        <span class="built_in">repp</span>(j, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!x[i][j])<span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> k = j;</span><br><span class="line">            <span class="keyword">while</span> (k &gt; <span class="number">1</span> &amp;&amp; !f[i][k - <span class="number">1</span>][i][k] &amp;&amp; !x[i][k - <span class="number">1</span>]) &#123;</span><br><span class="line">                x[i][k - <span class="number">1</span>] = x[i][k];</span><br><span class="line">                x[i][k] = <span class="number">0</span>;</span><br><span class="line">                k--;</span><br><span class="line">                <span class="keyword">if</span> (y[i][k] == x[i][k]) &#123;</span><br><span class="line">                    x[i][k] = y[i][k] = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (y[i][k] &amp;&amp; y[i][k] != x[i][k])<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    queue&lt;pair&lt;vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;, <span class="type">int</span>&gt;&gt;q;</span><br><span class="line">    q.<span class="built_in">push</span>(<span class="built_in">mp</span>(a, <span class="number">0</span>));</span><br><span class="line">    vis[a] = T_;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        x = q.<span class="built_in">front</span>().fi;</span><br><span class="line">        <span class="type">int</span> val = q.<span class="built_in">front</span>().se;</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="built_in">init</span>(F, <span class="number">0</span>);</span><br><span class="line">        <span class="type">bool</span> tmp = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">repp</span>(i, n)<span class="built_in">repp</span>(j, n)<span class="keyword">if</span> (x[i][j])F[x[i][j]] = tmp = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (!tmp)<span class="keyword">return</span> val;</span><br><span class="line">        <span class="built_in">repp</span>(i, n)<span class="built_in">repp</span>(j, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (F[b[i][j]])y[i][j] = b[i][j];</span><br><span class="line">            <span class="keyword">else</span> y[i][j] = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;vector&lt;<span class="type">int</span>&gt;&gt;xx = x, yy = y;</span><br><span class="line">        <span class="type">bool</span> suc;</span><br><span class="line">        suc = <span class="built_in">move</span>();</span><br><span class="line">        <span class="keyword">if</span> (suc &amp;&amp; vis[x] != T_)q.<span class="built_in">push</span>(<span class="built_in">mp</span>(x, val + <span class="number">1</span>)), vis[x] = T_;</span><br><span class="line">        x = xx, y = yy;</span><br><span class="line">        <span class="built_in">rotate</span>(<span class="number">1</span>);</span><br><span class="line">        suc = <span class="built_in">move</span>();</span><br><span class="line">        <span class="built_in">rotate</span>(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">if</span> (suc &amp;&amp; vis[x] != T_)q.<span class="built_in">push</span>(<span class="built_in">mp</span>(x, val + <span class="number">1</span>)), vis[x] = T_;</span><br><span class="line">        x = xx, y = yy;</span><br><span class="line">        <span class="built_in">rotate</span>(<span class="number">2</span>);</span><br><span class="line">        suc = <span class="built_in">move</span>();</span><br><span class="line">        <span class="built_in">rotate</span>(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (suc &amp;&amp; vis[x] != T_)q.<span class="built_in">push</span>(<span class="built_in">mp</span>(x, val + <span class="number">1</span>)), vis[x] = T_;</span><br><span class="line">        x = xx, y = yy;</span><br><span class="line">        <span class="built_in">rotate</span>(<span class="number">3</span>);</span><br><span class="line">        suc = <span class="built_in">move</span>();</span><br><span class="line">        <span class="built_in">rotate</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span> (suc &amp;&amp; vis[x] != T_)q.<span class="built_in">push</span>(<span class="built_in">mp</span>(x, val + <span class="number">1</span>)), vis[x] = T_;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">repp</span>(i, n)a[i].<span class="built_in">resize</span>(<span class="number">5</span>), b[i].<span class="built_in">resize</span>(<span class="number">5</span>), x[i].<span class="built_in">resize</span>(<span class="number">5</span>), y[i].<span class="built_in">resize</span>(<span class="number">5</span>), cpy[i].<span class="built_in">resize</span>(<span class="number">5</span>);</span><br><span class="line">    <span class="built_in">repp</span>(i, n)<span class="built_in">repp</span>(j, n)a[i][j] = b[i][j] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">repp</span>(i, n)<span class="built_in">repp</span>(j, n)<span class="built_in">repp</span>(ii, n)<span class="built_in">repp</span>(jj, n)f[i][j][ii][jj] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">repp</span>(i, m) &#123;</span><br><span class="line">        cin &gt;&gt; A &gt;&gt; B;</span><br><span class="line">        a[A + <span class="number">1</span>][B + <span class="number">1</span>] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">repp</span>(i, m) &#123;</span><br><span class="line">        cin &gt;&gt; A &gt;&gt; B;</span><br><span class="line">        b[A + <span class="number">1</span>][B + <span class="number">1</span>] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">repp</span>(i, w) &#123;</span><br><span class="line">        cin &gt;&gt; A &gt;&gt; B &gt;&gt; C &gt;&gt; D;</span><br><span class="line">        A++, B++, C++, D++;</span><br><span class="line">        f[A][B][C][D] = f[C][D][A][B] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> ans = <span class="built_in">bfs</span>();</span><br><span class="line">    <span class="keyword">if</span> (ans == <span class="number">-1</span>) cout &lt;&lt; <span class="string">&quot;Case &quot;</span> &lt;&lt; T_ &lt;&lt; <span class="string">&quot;: impossible\n\n&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> cout &lt;&lt; <span class="string">&quot;Case &quot;</span> &lt;&lt; T_ &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; ans &lt;&lt; <span class="string">&quot; moves\n\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/POJ1874-Trade-on-Verweggistan/"><img class="fill" src="https://pic.imgdb.cn/item/63b3947dbe43e0d30e4f7eaa.jpg" alt="POJ1874 Trade on Verweggistan"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.682Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:51:27.275Z" title="2023/1/3 10:51:27">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="level-item">4 分钟读完 (大约653个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/POJ1874-Trade-on-Verweggistan/">POJ1874 Trade on Verweggistan</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="http://poj.org/problem?id=1874">题目传送门</a></p>
<p><strong>本题最大难点：读题。</strong></p>
<p>首先说一下题意：</p>
<blockquote>
<p>有 $w$ 堆货物，第 $i$ 堆有 $b_i$ 个，从上往下给定每个货物的进价。<br>所有货物的售价都是 $10$，但是如果想买一件货物，必须要先买在它上面的所有货物。<br>求出最大利润，以及要达成这个利润，需要买多少个货物，可能有多种方案，从小到大输出。如果超过 $10$ 个只需要输出最小的 $10$ 个。</p>
</blockquote>
<p>显然先把每堆的前缀和从大到小排序，最大利润就是每堆 rk1 的前缀和加起来。</p>
<p>比较烦的是有的堆前缀和可能 $\le 0$。</p>
<p>这里有个小 trick：每堆在排序时加一个元素 $(0,0)$，表示前 $0$ 个的利润和是 $0$。这样就可以挤掉 $\le 0$ 的情况。</p>
<p>接下来处理货物数。</p>
<p>最小就是每堆 rk1 的长度的和，贪心计算出接下来最小的方案是什么：遍历一遍现有的所有方案，算出所有拓展的方式取 min，然后把这种方案加到答案队伍里。要去重。已经有 $10$ 个不重复的就 <code>break</code>。</p>
<p>注意：</p>
<ul>
<li>$b$ 有可能是 $0$</li>
<li>输出格式，每组数据之间要空一行</li>
<li>实在不行去 udebug 上找组数据测测</li>
</ul>
<p>我承认我加了 IO 优化才过。</p>
<p>Code</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;vector&lt;pair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; &gt; &gt;v;</span><br><span class="line"><span class="type">int</span> rk[<span class="number">20000</span>][<span class="number">55</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    v.<span class="built_in">resize</span>(n);</span><br><span class="line">    cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i, n) &#123;</span><br><span class="line">        cin &gt;&gt; m;</span><br><span class="line">        sum = <span class="number">0</span>;</span><br><span class="line">        v[i].<span class="built_in">clear</span>();</span><br><span class="line">        v[i].<span class="built_in">pb</span>(<span class="built_in">mp</span>(<span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">        <span class="built_in">rep</span>(j, m) &#123;</span><br><span class="line">            cin &gt;&gt; a;</span><br><span class="line">            sum += <span class="number">10</span> - a;</span><br><span class="line">            v[i].<span class="built_in">pb</span>(<span class="built_in">mp</span>(-sum, j + <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(v[i].<span class="built_in">begin</span>(), v[i].<span class="built_in">end</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    sum = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)sum -= v[i][<span class="number">0</span>].fi;</span><br><span class="line">    ans = <span class="number">1</span>;</span><br><span class="line">    cnt = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">init</span>(rk[<span class="number">0</span>], <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i, n) rk[<span class="number">0</span>][n] += v[i][<span class="number">0</span>].se;</span><br><span class="line">    <span class="built_in">rep</span>(I, <span class="number">10000</span>) &#123;</span><br><span class="line">        <span class="type">int</span> mn = MAXN, id1, id2;</span><br><span class="line">        <span class="built_in">rep</span>(i, ans) &#123;</span><br><span class="line">            <span class="built_in">rep</span>(j, n) &#123;</span><br><span class="line">                <span class="keyword">if</span> (rk[i][j] &lt; <span class="number">0</span> || rk[i][j] &gt;= (<span class="type">int</span>)v[j].<span class="built_in">size</span>() - <span class="number">1</span> || v[j][rk[i][j] + <span class="number">1</span>].fi != v[j][rk[i][j]].fi)<span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span> (rk[i][n] + v[j][rk[i][j] + <span class="number">1</span>].se - v[j][rk[i][j]].se &lt; mn) &#123;</span><br><span class="line">                    mn = rk[i][n] + v[j][rk[i][j] + <span class="number">1</span>].se - v[j][rk[i][j]].se;</span><br><span class="line">                    id1 = i;</span><br><span class="line">                    id2 = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (mn == MAXN)<span class="keyword">break</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i, n)rk[ans][i] = rk[id1][i];</span><br><span class="line">        rk[ans][id2]++;</span><br><span class="line">        rk[id1][id2] = <span class="number">-1</span>;</span><br><span class="line">        rk[ans][n] = mn;</span><br><span class="line">        <span class="keyword">if</span> (rk[ans][n] != rk[ans - <span class="number">1</span>][n])cnt++;</span><br><span class="line">        ans++;</span><br><span class="line">        <span class="keyword">if</span> (cnt == <span class="number">10</span>)<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Workyards &quot;</span> &lt;&lt; T_ &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Maximum profit is &quot;</span> &lt;&lt; sum &lt;&lt; <span class="string">&quot;.\n&quot;</span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Number of pruls to buy:&quot;</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i, ans)<span class="keyword">if</span> (!i || rk[i][n] != rk[i - <span class="number">1</span>][n])cout &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; rk[i][n];</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (cin &gt;&gt; n) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!n)<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (T_ &gt; <span class="number">1</span>)cout &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">solve</span>();</span><br><span class="line">        T_++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另一种也许可行的办法</p>
<p>爆搜出所有方案，放到 <code>set</code> 里去找到前十。上次 CSP-J 被 <code>set</code> 坑到 TLE ，就没敢用。</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/FFT%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D/"><img class="fill" src="https://pic.imgdb.cn/item/63b3823dbe43e0d30e381c80.jpg" alt="FFT字符串匹配"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.682Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:51:37.105Z" title="2023/1/3 10:51:37">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></span><span class="level-item">17 分钟读完 (大约2484个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/FFT%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D/">FFT字符串匹配</a></h1><div class="content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>字符串匹配，一个广泛而深刻的话题。</p>
<p>现有的字符串匹配算法有很多，例如 KMP，AC 自动机等等。但是，它们都是一位一位的处理，也就是说，基础操作是单个字符比较（哈希除外）。如果把整个字符串比较，效率是极其低下的。但将字符串转化为多项式后，多项式的运算无疑为整个字符串比较提供了绝佳的方法。</p>
<p>最知名但也最臭名昭著的多项式算法莫过于 FFT（快速傅里叶变换）了。实际上，它在字符串匹配方面也有很大的作用。</p>
<h2 id="前置芝士"><a href="#前置芝士" class="headerlink" title="前置芝士"></a>前置芝士</h2><ul>
<li>多项式基础<ul>
<li>卷积</li>
<li>FFT</li>
</ul>
</li>
</ul>
<p>不会的左转 OI Wiki。</p>
<ul>
<li>一些基础的数学常识<ul>
<li>完全平方公式</li>
</ul>
</li>
</ul>
<p>不会的去翻数学书。</p>
<h2 id="正题"><a href="#正题" class="headerlink" title="正题"></a>正题</h2><h3 id="普通字符串匹配"><a href="#普通字符串匹配" class="headerlink" title="普通字符串匹配"></a>普通字符串匹配</h3><p>设 $S$ 为模式串，$T$ 为文本串，$n&#x3D;\lvert S \rvert,m&#x3D;\lvert T \rvert$（字符串下标从 $0$ 开始）。</p>
<p>显然，两个字符串相同，当且仅当它们每一位都相同，这是一句废话。</p>
<p>我们联想到初中一年级的一句重要的话：**如果若干个非负数的和为 $0$，那么它们都为 $0$**。</p>
<p><em>和为 $0$</em> 正好对应了 <em>每一位都相同</em>，所以很容易得出这个 <strong>完全匹配函数</strong>（很重要！之后要考）</p>
<p>$$f(x)&#x3D;\sum\limits_{i&#x3D;0}^{n-1} (S_i-T_{x-n+i+1})^2$$</p>
<p>$f(x)$ 表示 $S$ 与 $T_{(x-n+1)\dots x}$ 的 <em>匹配值</em> 。</p>
<p>其中平方是为了保证每一项都是非负数。这样，只有每一项都为 $0$（即 $S_i&#x3D;T_{x+i-1}$），$f(x)$ 才会为 $0$。</p>
<p>显然这个柿子不是很好化简，所以我们要对它进行一点点的变形。</p>
<p>什么柿子容易计算呢？当然是卷积，即：</p>
<p>$$f(x)&#x3D;\sum\limits_{i+j&#x3D;x} A_iB_j$$</p>
<p>然而之前那个柿子中，$i$ 和 $x-n+i+1$ 加起来显然不是一个定值。如何把这个 $i$ 消掉呢？</p>
<p>我们考虑把 $S$ 整个串反转，这样原来的 $i$ 就变成了 $n-i-1$。</p>
<p>于是变成：</p>
<p>$$f(x)&#x3D;\sum\limits_{i&#x3D;0}^{n-1} (S_{n-i+1}-T_{x-n+i+1})^2$$</p>
<p>两个下标相加：</p>
<p>$$(n-i+1)+(x-n+i+1)&#x3D;x$$</p>
<p>好耶！消掉了！</p>
<p>于是那个柿子就可以写成：</p>
<p>$$f(x)&#x3D;\sum\limits_{i+j&#x3D;x}(S_i-T_j)^2$$</p>
<p>用完全平方公式拆开：</p>
<p>$$f(x)&#x3D;\sum\limits_{i+j&#x3D;x}S_i^2-2S_iT_j+T_j^2$$</p>
<p>显然第一项和第三项可以预处理得到，第二项就是 $S\cdot T$ 中 $x$ 次项的系数乘上 $-2$，只需要把 $S$ 和 $T$ 看成多项式，FFT 相乘即可。</p>
<p>复杂度 $O(n \log n)$。</p>
<p>还没有 KMP 快？别急，看接下来的。</p>
<h3 id="带通配符的字符串匹配"><a href="#带通配符的字符串匹配" class="headerlink" title="带通配符的字符串匹配"></a>带通配符的字符串匹配</h3><p><strong>通配符</strong>，即可以匹配任意字符的字符（当然也可以匹配通配符）。</p>
<p>显然这种问题 KMP 就无能为力了。然而，对于 FFT 做法，我们仍然可以用相似的思路解决。</p>
<p>我们发现，原来 <strong>完全匹配函数</strong> 为 $0$，当且仅当对应的两个字符相同。但是，现在有了通配符，条件应该改为满足以下两个中任意一个：</p>
<ul>
<li>对应两个字符相同</li>
<li>对应两个字符中有任意一个是通配符</li>
</ul>
<p>很容易想到设通配符为 $0$（当然其它任何字符都不能为 $0$）。<strong>完全匹配函数</strong> 就变成了：</p>
<p>$$f(x)&#x3D;\sum\limits_{i&#x3D;0}^{n-1} (S_i-T_{x-n+i+1})^2 \cdot S_iT_j$$</p>
<p>如果 $S_i&#x3D;0$ 或 $T_i&#x3D;0$，那么 $f(x)$ 仍然为 $0$。</p>
<p>老规矩，反转 $S$：</p>
<p>$$f(x)&#x3D;\sum\limits_{i&#x3D;0}^{n-1} (S_{n-i+1}-T_{x-n+i+1})^2 \cdot S_iT_j$$</p>
<p>化成卷积形式：</p>
<p>$$f(x)&#x3D;\sum\limits_{i+j&#x3D;x}(S_i-T_j)^2 \cdot S_iT_j$$</p>
<p>完全平方公式：</p>
<p>$$f(x)&#x3D;\sum\limits_{i+j&#x3D;x}S_i^3T_j-2S_i^2T_j^2+S_iT_j^3$$</p>
<p>看起来很复杂？但每一项还是卷积的形式，于是就用很多次 FFT 解决了。</p>
<p>复杂度 $O(n \log n)$。</p>
<h2 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h2><h3 id="模板题"><a href="#模板题" class="headerlink" title="模板题"></a>模板题</h3><p>残缺的字符串</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4173">Luogu 传送门</a></li>
<li><a target="_blank" rel="noopener" href="https://darkbzoj.cc/problem/4259">黑暗爆炸OJ 传送门</a></li>
</ul>
<h4 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h4><p>就是模板题，按上面方法做就完了。</p>
<p>注意数组大小好好算，$eps$ 我取的 $1$ 过了。</p>
<p>常数有点大，吸氧能过。</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by FGgirl */</span></span><br><span class="line"><span class="comment">/* ♥ Fantasyn &amp; Dormiveglia ♥ */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i,a,n) for(int i=a;i&lt;=n;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,n) forr(i,0,n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i,n) forr(i,1,n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a,i) memset(a,i,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 1100006</span></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="type">int</span> T_, case_;</span><br><span class="line"><span class="type">int</span> n1, n2, n = <span class="number">1</span>, len = <span class="number">0</span>;</span><br><span class="line">string s, t;</span><br><span class="line"><span class="type">int</span> S[MAXN], T[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Complex</span> &#123;</span><br><span class="line">    <span class="type">double</span> r, i;</span><br><span class="line">    <span class="built_in">Complex</span>() &#123; r = i = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="built_in">Complex</span>(<span class="type">double</span> r_, <span class="type">double</span> i_) :<span class="built_in">r</span>(r_), <span class="built_in">i</span>(i_) &#123;&#125;;</span><br><span class="line">    Complex <span class="keyword">operator</span>+(<span class="type">const</span> Complex&amp; x)<span class="type">const</span> &#123; <span class="keyword">return</span> <span class="built_in">Complex</span>(r + x.r, i + x.i); &#125;;</span><br><span class="line">    Complex <span class="keyword">operator</span>-(<span class="type">const</span> Complex&amp; x)<span class="type">const</span> &#123; <span class="keyword">return</span> <span class="built_in">Complex</span>(r - x.r, i - x.i); &#125;;</span><br><span class="line">    Complex <span class="keyword">operator</span>*(<span class="type">const</span> Complex&amp; x)<span class="type">const</span> &#123; <span class="keyword">return</span> <span class="built_in">Complex</span>(r * x.r - i * x.i, i * x.r + r * x.i); &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> rev[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FFT</span><span class="params">(Complex* a, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)<span class="keyword">if</span> (i &lt; rev[i])<span class="built_in">swap</span>(a[i], a[rev[i]]);</span><br><span class="line">    <span class="built_in">repp</span>(d, <span class="built_in">log2</span>(n)) &#123;</span><br><span class="line">        <span class="type">int</span> l = <span class="number">1</span> &lt;&lt; d;</span><br><span class="line">        Complex wn = <span class="built_in">Complex</span>(<span class="built_in">cos</span>(<span class="number">2.0</span> * pi / l), f * <span class="built_in">sin</span>(<span class="number">2.0</span> * pi / l));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i &lt; n;i += l) &#123;</span><br><span class="line">            Complex w = <span class="built_in">Complex</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">rep</span>(j, l / <span class="number">2</span>) &#123;</span><br><span class="line">                Complex t = w * a[i + j + l / <span class="number">2</span>], u = a[i + j];</span><br><span class="line">                a[i + j] = u + t;</span><br><span class="line">                a[i + j + l / <span class="number">2</span>] = u - t;</span><br><span class="line">                w = w * wn;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="number">-1</span>)<span class="built_in">rep</span>(i, n)a[i].r /= n;</span><br><span class="line">&#125;</span><br><span class="line">Complex a[MAXN], b[MAXN], ans[MAXN];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;v;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n1 &gt;&gt; n2 &gt;&gt; s &gt;&gt; t;</span><br><span class="line">    <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">while</span> (n &lt; n1 + n2)n *= <span class="number">2</span>, len++;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)rev[i] = (rev[i / <span class="number">2</span>] / <span class="number">2</span> | ((i &amp; <span class="number">1</span>) &lt;&lt; (len - <span class="number">1</span>)));</span><br><span class="line">    <span class="built_in">rep</span>(i, n1)S[i] = (<span class="built_in">isalpha</span>(s[i]) ? s[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i, n2)T[i] = (<span class="built_in">isalpha</span>(t[i]) ? t[i] - <span class="string">&#x27;a&#x27;</span> + <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i, n)a[i] = <span class="built_in">Complex</span>(S[i] * S[i] * S[i], <span class="number">0</span>), b[i] = <span class="built_in">Complex</span>(T[i], <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">FFT</span>(a, <span class="number">1</span>), <span class="built_in">FFT</span>(b, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i, n)ans[i] = a[i] * b[i];</span><br><span class="line">    <span class="built_in">rep</span>(i, n)a[i] = <span class="built_in">Complex</span>(S[i] * S[i], <span class="number">0</span>), b[i] = <span class="built_in">Complex</span>(T[i] * T[i], <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">FFT</span>(a, <span class="number">1</span>), <span class="built_in">FFT</span>(b, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i, n)ans[i] = ans[i] - <span class="built_in">Complex</span>(<span class="number">2</span>, <span class="number">0</span>) * a[i] * b[i];</span><br><span class="line">    <span class="built_in">rep</span>(i, n)a[i] = <span class="built_in">Complex</span>(S[i], <span class="number">0</span>), b[i] = <span class="built_in">Complex</span>(T[i] * T[i] * T[i], <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">FFT</span>(a, <span class="number">1</span>), <span class="built_in">FFT</span>(b, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">rep</span>(i, n)ans[i] = ans[i] + a[i] * b[i];</span><br><span class="line">    <span class="built_in">FFT</span>(ans, <span class="number">-1</span>);</span><br><span class="line">    forr(i, n1 - <span class="number">1</span>, n2 - <span class="number">1</span>)<span class="keyword">if</span> (<span class="built_in">fabs</span>(ans[i].r) &lt;= <span class="number">1</span>)v.<span class="built_in">pb</span>(i - n1 + <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span> (v.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; v.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">rep</span>(i, v.<span class="built_in">size</span>())cout &lt;&lt; v[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>;case_ &lt;= T_;case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="练习题"><a href="#练习题" class="headerlink" title="练习题"></a>练习题</h3><p>CF528D Fuzzy Search</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/CF528D">Luogu 传送门</a></li>
<li><a target="_blank" rel="noopener" href="https://codeforces.com/contest/528/problem/D">Codeforces 传送门</a></li>
</ul>
<h4 id="题目大意"><a href="#题目大意" class="headerlink" title="题目大意"></a>题目大意</h4><p>有两个字符串 $S,T$，长度分别为 $n,m$，字符集为 ${A,C,G,T}$，和一个整数 $k$。</p>
<p>我们称 <em>$S$ 在 $T$ 的第 $i$ 位出现了</em>，当且仅当把 $S$ 的首字符和 $T$ 的第 $i$ 个字符对齐后，$S$ 中的每一个字符能够在 $T$ 中找到一个位置偏差不超过 $k$ 的相同字符。</p>
<p>即对于所有的 $j \in[1,n]$，都存在一个 $p \in [1,m]$ 使得 $|(i+j-1)-p| \leq k$ 且 $S_p&#x3D;T_j$ 。</p>
<p>请求出 $S$ 在 $T$ 中出现的次数。</p>
<h4 id="做法-1"><a href="#做法-1" class="headerlink" title="做法"></a>做法</h4><p>首先把四种字母分开来考虑，最后取四个集合的交即可。</p>
<p>接下来假设只考虑字母 <code>A</code>，其余三个同理。</p>
<p>先把 $S$ 和 $T$ 除了 <code>A</code> 的部分都去掉（即空白），其余位置涂色。</p>
<p>接下来对 $T$ 处理：由于 $T$ 中的一个 <code>A</code>（假设在第 $i$ 位）可以影响到 $[i-k,i+k]$ 这些位置，所以把这些位置全都涂色。</p>
<p>接下来直接匹配即可。对于 $S$ 上有颜色的位置，$T$ 对应位置一定要有颜色；而对于 $S$ 上空白的位置，$T$ 对应位置可以有颜色，也可以是空白。</p>
<p>于是把 $T$ 的涂色部分看成 $1$，空白部分看成 $2$，$S$ 的涂色部分看成 $1$，空白部分看成 $0$（即通配符）。</p>
<p>复杂度 $O(n \log n)$。</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by FGgirl */</span></span><br><span class="line"><span class="comment">/* ♥ Fantasyn &amp; Dormiveglia ♥ */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i,a,n) for(int i=a;i&lt;=n;i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,n) forr(i,0,n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i,n) forr(i,1,n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a,i) memset(a,i,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 1100006</span></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="type">int</span> T_, case_;</span><br><span class="line"><span class="type">int</span> n1, n2, n = <span class="number">1</span>, len = <span class="number">0</span>, k;</span><br><span class="line">string s, t;</span><br><span class="line"><span class="type">int</span> S[MAXN], T[MAXN];</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Complex</span> &#123;</span><br><span class="line">    <span class="type">double</span> r, i;</span><br><span class="line">    <span class="built_in">Complex</span>() &#123; r = i = <span class="number">0</span>; &#125;</span><br><span class="line">    <span class="built_in">Complex</span>(<span class="type">double</span> r_, <span class="type">double</span> i_) :<span class="built_in">r</span>(r_), <span class="built_in">i</span>(i_) &#123;&#125;;</span><br><span class="line">    Complex <span class="keyword">operator</span>+(<span class="type">const</span> Complex&amp; x)<span class="type">const</span> &#123; <span class="keyword">return</span> <span class="built_in">Complex</span>(r + x.r, i + x.i); &#125;;</span><br><span class="line">    Complex <span class="keyword">operator</span>-(<span class="type">const</span> Complex&amp; x)<span class="type">const</span> &#123; <span class="keyword">return</span> <span class="built_in">Complex</span>(r - x.r, i - x.i); &#125;;</span><br><span class="line">    Complex <span class="keyword">operator</span>*(<span class="type">const</span> Complex&amp; x)<span class="type">const</span> &#123; <span class="keyword">return</span> <span class="built_in">Complex</span>(r * x.r - i * x.i, i * x.r + r * x.i); &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> rev[MAXN];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FFT</span><span class="params">(Complex* a, <span class="type">int</span> f)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)<span class="keyword">if</span> (i &lt; rev[i])<span class="built_in">swap</span>(a[i], a[rev[i]]);</span><br><span class="line">    <span class="built_in">repp</span>(d, <span class="built_in">log2</span>(n)) &#123;</span><br><span class="line">        <span class="type">int</span> l = <span class="number">1</span> &lt;&lt; d;</span><br><span class="line">        Complex wn = <span class="built_in">Complex</span>(<span class="built_in">cos</span>(<span class="number">2.0</span> * pi / l), f * <span class="built_in">sin</span>(<span class="number">2.0</span> * pi / l));</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;i &lt; n;i += l) &#123;</span><br><span class="line">            Complex w = <span class="built_in">Complex</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">rep</span>(j, l / <span class="number">2</span>) &#123;</span><br><span class="line">                Complex t = w * a[i + j + l / <span class="number">2</span>], u = a[i + j];</span><br><span class="line">                a[i + j] = u + t;</span><br><span class="line">                a[i + j + l / <span class="number">2</span>] = u - t;</span><br><span class="line">                w = w * wn;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (f == <span class="number">-1</span>)<span class="built_in">rep</span>(i, n)a[i].r /= n;</span><br><span class="line">&#125;</span><br><span class="line">Complex a[MAXN], b[MAXN], ans[MAXN];</span><br><span class="line"><span class="type">char</span> C[] = &#123; <span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;G&#x27;</span>,<span class="string">&#x27;T&#x27;</span> &#125;;</span><br><span class="line"><span class="type">int</span> d;</span><br><span class="line"><span class="type">int</span> sum[MAXN], SUM = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n2 &gt;&gt; n1 &gt;&gt; k &gt;&gt; t &gt;&gt; s;</span><br><span class="line">    <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(), s.<span class="built_in">end</span>());</span><br><span class="line">    <span class="keyword">while</span> (n &lt; n1 + n2)n *= <span class="number">2</span>, len++;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)rev[i] = (rev[i / <span class="number">2</span>] / <span class="number">2</span> | ((i &amp; <span class="number">1</span>) &lt;&lt; (len - <span class="number">1</span>)));</span><br><span class="line">    <span class="built_in">rep</span>(c, <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="built_in">rep</span>(i, n1)S[i] = (s[i] == C[c]);</span><br><span class="line">        d = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="built_in">min</span>(k, n2))d += (t[i] == C[c]);</span><br><span class="line">        <span class="built_in">rep</span>(i, n2) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i + k &lt; n2)d += (t[i + k] == C[c]);</span><br><span class="line">            T[i] = (d &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">2</span>);</span><br><span class="line">            <span class="keyword">if</span> (i - k &gt;= <span class="number">0</span>)d -= (t[i - k] == C[c]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">rep</span>(i, n)a[i] = <span class="built_in">Complex</span>(S[i] * S[i] * S[i], <span class="number">0</span>), b[i] = <span class="built_in">Complex</span>(T[i], <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">FFT</span>(a, <span class="number">1</span>), <span class="built_in">FFT</span>(b, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">rep</span>(i, n)ans[i] = a[i] * b[i];</span><br><span class="line">        <span class="built_in">rep</span>(i, n)a[i] = <span class="built_in">Complex</span>(S[i] * S[i], <span class="number">0</span>), b[i] = <span class="built_in">Complex</span>(T[i] * T[i], <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">FFT</span>(a, <span class="number">1</span>), <span class="built_in">FFT</span>(b, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">rep</span>(i, n)ans[i] = ans[i] - <span class="built_in">Complex</span>(<span class="number">2</span>, <span class="number">0</span>) * a[i] * b[i];</span><br><span class="line">        <span class="built_in">rep</span>(i, n)a[i] = <span class="built_in">Complex</span>(S[i], <span class="number">0</span>), b[i] = <span class="built_in">Complex</span>(T[i] * T[i] * T[i], <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">FFT</span>(a, <span class="number">1</span>), <span class="built_in">FFT</span>(b, <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">rep</span>(i, n)ans[i] = ans[i] + a[i] * b[i];</span><br><span class="line">        <span class="built_in">FFT</span>(ans, <span class="number">-1</span>);</span><br><span class="line">        forr(i, n1 - <span class="number">1</span>, n2 - <span class="number">1</span>)<span class="keyword">if</span> (<span class="built_in">fabs</span>(ans[i].r) &lt;= <span class="number">1</span>)sum[i - n1 + <span class="number">1</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">rep</span>(i, n2 - n1 + <span class="number">1</span>)<span class="keyword">if</span> (sum[i] == <span class="number">4</span>)SUM++;</span><br><span class="line">    cout &lt;&lt; SUM;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>;case_ &lt;= T_;case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/URAL1095-Nikifor-3/"><img class="fill" src="https://pic.imgdb.cn/item/63b391e9be43e0d30e4c83d9.jpg" alt="URAL1095 Nikifor 3"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.682Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:51:19.539Z" title="2023/1/3 10:51:19">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="level-item">2 分钟读完 (大约294个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/URAL1095-Nikifor-3/">URAL1095 Nikifor 3</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://acm.timus.ru/problem.aspx?space=1&num=1095">题目传送门</a></p>
<p>首先你得先打个表，就像这样：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> a[] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i, <span class="number">4</span>) cout &lt;&lt; a[i], x = x * <span class="number">10</span> + a[i];</span><br><span class="line">    cout &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; x % <span class="number">7</span> &lt;&lt; endl;</span><br><span class="line">&#125; <span class="keyword">while</span> (<span class="built_in">next_permutation</span>(a, a + <span class="number">4</span>));</span><br></pre></td></tr></table></figure>

<p>然后你就能惊讶地发现，对于每个 $i\in [1,7]$，都有至少一个 $1,2,3,4$ 的排列满足：$(组成的四位数)\equiv i\pmod i$。</p>
<p>所以考虑先在字符串中去掉 $1,2,3,4$，将剩余的所有数字放在最后面，并处理出这串数 $\bmod 7$ 是多少，然后把 $1,2,3,4$ 按照某种顺序放在最前面就行了。</p>
<p>之所以要把剩余部分放在最后面而不是最前面的原因是，如果有这样一组数据：<code>001234</code>，就会出现前导零。</p>
<p>Code</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> T_, case_;</span><br><span class="line"><span class="type">int</span> A[<span class="number">7</span>][<span class="number">4</span>], sum, p;</span><br><span class="line">string s, t;</span><br><span class="line"><span class="type">bool</span> f[<span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    sum = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">init</span>(f, <span class="number">0</span>);</span><br><span class="line">    cin &gt;&gt; s;</span><br><span class="line">    t = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    p = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i, s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        <span class="type">int</span> x = s[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (x &gt;= <span class="number">1</span> &amp;&amp; x &lt;= <span class="number">4</span> &amp;&amp; !f[x])f[x] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            t += s[i];</span><br><span class="line">            p = p * <span class="number">10</span> % <span class="number">7</span>;</span><br><span class="line">            sum = (sum * <span class="number">10</span> + x) % <span class="number">7</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">rep</span>(i, <span class="number">7</span>)<span class="keyword">if</span> ((i * p + sum) % <span class="number">7</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">rep</span>(j, <span class="number">4</span>)cout &lt;&lt; A[i][j];</span><br><span class="line">        cout &lt;&lt; t &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">init</span>(A, <span class="number">-1</span>);</span><br><span class="line">    <span class="type">int</span> a[] = &#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">rep</span>(i, <span class="number">4</span>) x = x * <span class="number">10</span> + a[i];</span><br><span class="line">        <span class="keyword">if</span> (A[x % <span class="number">7</span>][<span class="number">0</span>] == <span class="number">-1</span>)<span class="built_in">rep</span>(i, <span class="number">4</span>)A[x % <span class="number">7</span>][i] = a[i];</span><br><span class="line">    &#125; <span class="keyword">while</span> (<span class="built_in">next_permutation</span>(a, a + <span class="number">4</span>));</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line">    cin &gt;&gt; T_;</span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>; case_ &lt;= T_; case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/CF1680F-Lenient-Vertex-Cover/"><img class="fill" src="https://pic.imgdb.cn/item/63b39210be43e0d30e4ca847.jpg" alt="CF1680F Lenient Vertex Cover"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.669Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:51:43.991Z" title="2023/1/3 10:51:43">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></span><span class="level-item">4 分钟读完 (大约556个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/CF1680F-Lenient-Vertex-Cover/">CF1680F Lenient Vertex Cover</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://codeforces.com/contest/1680/problem/F">题目传送门</a></p>
<p>DFS 树的性质。</p>
<p>首先注意到题面中的这一句话：</p>
<blockquote>
<p>最多只能有一条边，满足两个顶点都在这个点集中。</p>
</blockquote>
<p>显然，“最多只能有一条边”意思就是有 $0$ 条或 $1$ 条。</p>
<h3 id="0-条"><a href="#0-条" class="headerlink" title="0 条"></a>0 条</h3><p>所以每条边都恰好只有一个顶点在点集中。</p>
<p>很自然想到二分图染色，每条边两个顶点颜色不同。</p>
<p>所以只要这个图是二分图，就一定有解。</p>
<h3 id="1-条"><a href="#1-条" class="headerlink" title="1 条"></a>1 条</h3><p>有一条边的两个点同色，那么去掉这个边后，剩下的图一定就是一个二分图，就转化成了上一个情况。</p>
<p>先 DFS 一遍。一个<del>显然的</del>重要的性质是：对于原图中的每条边，要么是 DFS 树中的一条边，要么是一条返祖边（即一个点连向它祖先的边）。</p>
<p>因为二分图中没有奇环，所以这条去掉的边一定在所有奇环上，而不能在任何一个偶环上（这样去掉之后就全是偶环了）。</p>
<p>考虑去掉什么边。</p>
<h4 id="返祖边"><a href="#返祖边" class="headerlink" title="返祖边"></a>返祖边</h4><p>因为一个环在 DFS 树中一定是一条链加上一条返祖边，所以在 DFS 遇到返祖边时判断这个环是奇环还是偶环，就能统计出奇环数量了。如果奇环数量为 $1$，那么直接去掉那条返祖边即可。</p>
<h4 id="树边"><a href="#树边" class="headerlink" title="树边"></a>树边</h4><p>在统计环时把环上的所有树边都标记 $+1$，最后看是否有一个树边满足：</p>
<ul>
<li>所在的奇环数 $&#x3D;$ 奇环总数</li>
<li>所在的偶环数 $&#x3D;0$</li>
</ul>
<p>即可。</p>
<p>标记时用树上差分即可，不会的同学可以左转 OI Wiki。</p>
<p>最后判断答案时只需要再 DFS 一遍，按照深度奇偶性染色即可。</p>
<p><strong>注意</strong>：有可能结果是：一条边满足两个顶点都不在点集中，其他每条边都有一个顶点在点集中。这时候只需要把所有颜色反转即可。</p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/paste/ih3ur3wt">Code</a></p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/ABC255%E6%AF%94%E8%B5%9B%E7%AC%94%E8%AE%B0/"><img class="fill" src="https://pic.imgdb.cn/item/63b38655be43e0d30e3cfec8.jpg" alt="ABC255比赛笔记"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.669Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-03T02:51:48.129Z" title="2023/1/3 10:51:48">2023-01-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%AF%94%E8%B5%9B%E7%AC%94%E8%AE%B0/">比赛笔记</a></span><span class="level-item">16 分钟读完 (大约2428个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/ABC255%E6%AF%94%E8%B5%9B%E7%AC%94%E8%AE%B0/">ABC255比赛笔记</a></h1><div class="content"><p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc255">比赛传送门</a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>做出来 7 题，第一次做出 Ex，感觉还不错。</p>
<p>上一次做出 7 题还是在很久以前呢 &#x2F;wx</p>
<p>为啥 ABC 前几题越来越难了啊，感觉 C 都有 D 的水平了。</p>
<p>交错程序一发，可真有我的。</p>
<h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><h3 id="A-You-should-output-ARC-though-this-is-ABC"><a href="#A-You-should-output-ARC-though-this-is-ABC" class="headerlink" title="A - You should output ARC, though this is ABC."></a>A - You should output ARC, though this is ABC.</h3><p>题目名字好废话，看个乐子就好。</p>
<h3 id="B-Light-It-Up"><a href="#B-Light-It-Up" class="headerlink" title="B - Light It Up"></a>B - Light It Up</h3><h4 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h4><p>给定若干个点，其中一些点上有灯，灯能照到半径为 $R$ 的圆内的地方。求要找到所有点，$R$ 的最小值，$N\le 1000$。</p>
<h4 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h4><p>对于每个点找离它最近的灯，把所有距离取 $\max$。</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,n) forr(i,0,n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i,n) forr(i,1,n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a,i) memset(a,i,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> <span class="keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="string">&#x27;=&#x27;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T_, case_;</span><br><span class="line"><span class="type">int</span> n, k, a;</span><br><span class="line"><span class="type">bool</span> f[<span class="number">1010</span>];</span><br><span class="line"><span class="type">double</span> x[<span class="number">1010</span>], y[<span class="number">1010</span>], mn, ans = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; k;</span><br><span class="line">    <span class="built_in">rep</span>(i, k)cin &gt;&gt; a, f[a - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)cin &gt;&gt; x[i] &gt;&gt; y[i];</span><br><span class="line">    <span class="built_in">rep</span>(i, n) &#123;</span><br><span class="line">        mn = MAXN;</span><br><span class="line">        <span class="built_in">rep</span>(j, n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!f[j])<span class="keyword">continue</span>;</span><br><span class="line">            mn = <span class="built_in">min</span>(mn, <span class="built_in">sqrt</span>((x[i] - x[j]) * (x[i] - x[j]) + (y[i] - y[j]) * (y[i] - y[j])));</span><br><span class="line">        &#125;</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, mn);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; fixed &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">10</span>) &lt;&lt; ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>;case_ &lt;= T_;case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="C-±1-Operation-1"><a href="#C-±1-Operation-1" class="headerlink" title="C - ±1 Operation 1"></a>C - ±1 Operation 1</h3><h4 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h4><p>给定一个等差数列的首项 $A$，公差 $D$ 和项数 $N$，每次操作可以将 $X+1$ 或 $-1$。求最少要多少次操作才能使 $X$ 和等差数列中某个数相等。</p>
<p>$N\le 10^{12},-10 ^6 \le D \le 10^6, -10^{18} \le X,A\le 10^{18}$</p>
<h4 id="做法-1"><a href="#做法-1" class="headerlink" title="做法"></a>做法</h4><p>首先，如果 $D&#x3D;0$，那么 $X$ 只能变成 $A$，输出 $\left| X-A\right|$ 即可。</p>
<p>如果 $D&lt;0$，则把 $A$ 变成 $A+D\cdot (N-1)$，把 $D$ 变成 $-D$，这样就转化成 $D&gt;0$ 的情况了。</p>
<p>现在已经保证了 $D&gt;0$，所以就找出离 $X$ 最近的在等差数列中的值 $Y$，用 $\left| X-Y\right|$ 更新答案，FG 因为不会考虑边界就直接左右多偏移几个，注意判断超出等差数列的情况。</p>
<h4 id="Code-1"><a href="#Code-1" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,n) forr(i,0,n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i,n) forr(i,1,n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a,i) memset(a,i,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> <span class="keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="string">&#x27;=&#x27;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T_, case_;</span><br><span class="line">ll x, a, d, n, y, ans = <span class="number">-1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; x &gt;&gt; a &gt;&gt; d &gt;&gt; n;</span><br><span class="line">    <span class="keyword">if</span> (!d) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">abs</span>(x - a);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (d &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        a += d * (n - <span class="number">1</span>);</span><br><span class="line">        d *= <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;= a) &#123;</span><br><span class="line">        y = a + (x - a) / d * d;</span><br><span class="line">        <span class="keyword">for</span> (ll z = y - d * <span class="number">3</span>;z &lt;= y + d * <span class="number">3</span>;z += d) &#123;</span><br><span class="line">            <span class="keyword">if</span> (z&lt;a || z&gt;a + d * (n - <span class="number">1</span>))<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span> (ans == <span class="number">-1</span> || ans &gt; <span class="built_in">abs</span>(x - z))ans = <span class="built_in">abs</span>(x - z);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ll z;</span><br><span class="line">    z = a;</span><br><span class="line">    <span class="keyword">if</span> (ans == <span class="number">-1</span> || ans &gt; <span class="built_in">abs</span>(x - z))ans = <span class="built_in">abs</span>(x - z);</span><br><span class="line">    z = a + d * (n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (ans == <span class="number">-1</span> || ans &gt; <span class="built_in">abs</span>(x - z))ans = <span class="built_in">abs</span>(x - z);</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>;case_ &lt;= T_;case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="D-±1-Operation-2"><a href="#D-±1-Operation-2" class="headerlink" title="D - ±1 Operation 2"></a>D - ±1 Operation 2</h3><h4 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h4><p>给定一个长度为 $N$ 的数组 $A$，每次操作可以把其中一个数 $+1$ 或 $-1$，有 $Q$ 次查询，第 $i$ 次询问最少多少次可以全部变成 $X_i$。</p>
<p>$N,Q \le 2\times 10^5,A_i,X_i \le 10^9$</p>
<h4 id="做法-2"><a href="#做法-2" class="headerlink" title="做法"></a>做法</h4><p>先排序，处理出前缀和。</p>
<p>查询时先 <code>lower_bound</code> 出有 $P$ 个数 $&lt; X_i$，用前缀和处理，这部分答案就是 $P\cdot X_i-sum_p$，其余的 $\ge X_i$ 的部分同理。</p>
<h4 id="Code-2"><a href="#Code-2" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,n) forr(i,0,n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i,n) forr(i,1,n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a,i) memset(a,i,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> <span class="keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="string">&#x27;=&#x27;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T_, case_;</span><br><span class="line"><span class="type">int</span> n, q;</span><br><span class="line">ll a[<span class="number">200005</span>], x, sum[<span class="number">200005</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    <span class="built_in">repp</span>(i, n)cin &gt;&gt; a[i];</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + n);</span><br><span class="line">    <span class="built_in">repp</span>(i, n)sum[i] = sum[i - <span class="number">1</span>] + a[i];</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        cin &gt;&gt; x;</span><br><span class="line">        ll p = <span class="built_in">upper_bound</span>(a + <span class="number">1</span>, a + <span class="number">1</span> + n, x) - a;</span><br><span class="line">        cout &lt;&lt; (p - <span class="number">1</span>) * x - sum[p - <span class="number">1</span>] + (sum[n] - sum[p - <span class="number">1</span>]) - (n - p + <span class="number">1</span>) * x &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>;case_ &lt;= T_;case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="E-Lucky-Numbers"><a href="#E-Lucky-Numbers" class="headerlink" title="E - Lucky Numbers"></a>E - Lucky Numbers</h3><h4 id="题意-3"><a href="#题意-3" class="headerlink" title="题意"></a>题意</h4><p>有一个未知的长度为 $N$ 的数列 $A$ 满足 $A_i+A_{i+1}&#x3D;S_i$，给定 $S$ 和一个大小为 $M$ 的集合 $X$，求最多有多少个 $i$ 满足 $A_i \in X$。</p>
<p>$N \le 10^6,M \le 10,-10^9 \le S_i,X_i \le 10^9$</p>
<h4 id="做法-3"><a href="#做法-3" class="headerlink" title="做法"></a>做法</h4><p>先钦定 $A_1&#x3D;0$，推出整个 $A$。</p>
<p>容易得到，如果 $A_1+1$，那么必定会有 $A_2-1,A_3+1,A_4-1,A_5+1\dots$，即奇数下标的 $+1$，偶数下标的 $-1$。</p>
<p>对于每个奇数的 $i$ 处理出所有 $X_j-A_i$，对于每个偶数的 $i$ 处理出所有 $A_i-X_j$，这样就可以统计出 $A_1+W$ 后的答案，即为 $W$ 在统计中出现的次数。在左右出现次数中取最大值即可。</p>
<h4 id="Code-3"><a href="#Code-3" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (ll i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,n) forr(i,0,n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i,n) forr(i,1,n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a,i) memset(a,i,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> <span class="keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="string">&#x27;=&#x27;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line">ll T_, case_;</span><br><span class="line">ll n, m, s[<span class="number">100005</span>], x[<span class="number">20</span>], a[<span class="number">100005</span>], ans = <span class="number">0</span>;</span><br><span class="line">vector&lt;ll&gt;v;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="built_in">rep</span>(i, n - <span class="number">1</span>)cin &gt;&gt; s[i];</span><br><span class="line">    <span class="built_in">rep</span>(i, m)cin &gt;&gt; x[i];</span><br><span class="line">    forr(i, <span class="number">1</span>, n - <span class="number">1</span>)a[i] = s[i - <span class="number">1</span>] - a[i - <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">rep</span>(i, n) &#123;</span><br><span class="line">        <span class="built_in">rep</span>(j, m) &#123;</span><br><span class="line">            ll tmp;</span><br><span class="line">            <span class="keyword">if</span> (i % <span class="number">2</span> == <span class="number">0</span>)tmp = a[i] - x[j];</span><br><span class="line">            <span class="keyword">else</span> tmp = x[j] - a[i];</span><br><span class="line">            v.<span class="built_in">pb</span>(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(v.<span class="built_in">begin</span>(), v.<span class="built_in">end</span>());</span><br><span class="line">    ll l, r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (r &lt; (ll)v.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        l = r;</span><br><span class="line">        <span class="keyword">while</span> (r + <span class="number">1</span> &lt; (ll)v.<span class="built_in">size</span>() &amp;&amp; v[r + <span class="number">1</span>] == v[l])r++;</span><br><span class="line">        ans = <span class="built_in">max</span>(ans, r - l + <span class="number">1</span>);</span><br><span class="line">        r++;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>;case_ &lt;= T_;case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="F-Pre-order-and-In-order"><a href="#F-Pre-order-and-In-order" class="headerlink" title="F - Pre-order and In-order"></a>F - Pre-order and In-order</h3><h4 id="题意-4"><a href="#题意-4" class="headerlink" title="题意"></a>题意</h4><p>给出一棵树的前序遍历 $P$ 和中序遍历 $I$，求这棵树的形态，或判断无解。</p>
<p>$N \le 2\times 10^5$</p>
<h4 id="做法-4"><a href="#做法-4" class="headerlink" title="做法"></a>做法</h4><p>CSP 初赛经典题了属于是。</p>
<p>考虑 $P_{l\dots r}$ 匹配 $I_{L\dots R}$。</p>
<p>显然 $P_l$ 为根，所以就可将 $I$ 划分成两段，即 $P_l$ 的左边和右边。知道左右子树大小后，就可以将 $P_{L+1\dots R}$ 划分成两段，递归即可。</p>
<p>如果 $P_l$ 在 $I_{L\dots R}$ 中没有出现则判断无解。</p>
<h4 id="Code-4"><a href="#Code-4" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,n) forr(i,0,n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i,n) forr(i,1,n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a,i) memset(a,i,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> <span class="keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="string">&#x27;=&#x27;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T_, case_;</span><br><span class="line"><span class="type">int</span> n, a[<span class="number">200005</span>], b[<span class="number">200005</span>], p[<span class="number">200005</span>];</span><br><span class="line"><span class="type">int</span> son[<span class="number">200005</span>][<span class="number">2</span>];</span><br><span class="line"><span class="type">bool</span> ans = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> L, <span class="type">int</span> R)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (l &gt; r || L &gt; R || !ans)<span class="keyword">return</span>;</span><br><span class="line">    <span class="type">int</span> x = a[l], y = p[a[l]], lenl = y - L, lenr = R - y;</span><br><span class="line">    <span class="keyword">if</span> (y&lt;L || y&gt;R)ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (lenl &gt; <span class="number">0</span>)son[x][<span class="number">0</span>] = a[l + <span class="number">1</span>] + <span class="number">1</span>, <span class="built_in">dfs</span>(l + <span class="number">1</span>, l + lenl, L, y - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (lenr &gt; <span class="number">0</span>)son[x][<span class="number">1</span>] = a[l + lenl + <span class="number">1</span>] + <span class="number">1</span>, <span class="built_in">dfs</span>(l + lenl + <span class="number">1</span>, r, y + <span class="number">1</span>, R);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)cin &gt;&gt; a[i], a[i]--;</span><br><span class="line">    <span class="built_in">rep</span>(i, n)cin &gt;&gt; b[i], b[i]--, p[b[i]] = i;</span><br><span class="line">    <span class="keyword">if</span> (a[<span class="number">0</span>]) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>, n - <span class="number">1</span>, <span class="number">0</span>, n - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (!ans)cout &lt;&lt; <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">rep</span>(i, n)cout &lt;&lt; son[i][<span class="number">0</span>] &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; son[i][<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>;case_ &lt;= T_;case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="G-Constrained-Nim"><a href="#G-Constrained-Nim" class="headerlink" title="G - Constrained Nim"></a>G - Constrained Nim</h3><p>没看。</p>
<h3 id="Ex-Range-Harvest-Query"><a href="#Ex-Range-Harvest-Query" class="headerlink" title="Ex - Range Harvest Query"></a>Ex - Range Harvest Query</h3><h4 id="题意-5"><a href="#题意-5" class="headerlink" title="题意"></a>题意</h4><p>有 $N$ 棵树，第 $0$ 天它们都没有果子，每天晚上，第 $i$ 棵树会结出 $i$ 个果子。</p>
<p>共有 $Q$ 次采摘，第 $i$ 次在第 $D_i$ 天晚上，采走第 $L_i$ 到 $R_i$ 棵树上所有的果子。</p>
<p>对于每次采摘，输出采到了多少果子，对 $998244353$ 取模。</p>
<p>$N,D_i \le 10^{18},Q \le 2 \times 10^5,D_i&lt;D_{i+1}$</p>
<h4 id="做法-5"><a href="#做法-5" class="headerlink" title="做法"></a>做法</h4><p>珂朵莉树模板题。</p>
<p>感谢 lxl！</p>
<p>维护每棵树最后被采摘的区间，每次用等差数列求和处理区间贡献，再区间赋值即可。</p>
<p>由于每次操作只会 <code>split</code> 出 至多 $2$ 个区间，所以区间总数是 $O(Q)$ 的，并且查询复杂度和包含的区间个数有关，查询后会将这些区间全部合并到一起，所以最多只会查询 $O(Q)$ 个区间，算上 <code>set</code> 复杂度，总时间复杂度为 $O(Q \log Q)$。</p>
<h4 id="Code-5"><a href="#Code-5" class="headerlink" title="Code"></a>Code</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Code by Reflective-FG */</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ll long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> forr(i, a, b) for (int i = a; i &lt;= b; i++)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rep(i,n) forr(i,0,n-1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> repp(i,n) forr(i,1,n)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mp make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> init(a,i) memset(a,i,sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mod 1000000007</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MOD 998244353</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAXN 0x3f3f3f3f</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> <span class="keyword">error</span>(args...) &#123; string _s = #args; replace(_s.begin(), _s.end(), <span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27; &#x27;</span>); stringstream _ss(_s); istream_iterator<span class="string">&lt;string&gt;</span> _it(_ss); err(_it, args); &#125;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it)</span> </span>&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... Args&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">err</span><span class="params">(istream_iterator&lt;string&gt; it, T a, Args... args)</span> </span>&#123;</span><br><span class="line">    cerr &lt;&lt; *it &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; <span class="string">&#x27;=&#x27;</span> &lt;&lt; <span class="string">&#x27; &#x27;</span> &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">err</span>(++it, args...);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> T_, case_;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    ll l, r;</span><br><span class="line">    <span class="keyword">mutable</span> ll val;</span><br><span class="line">    <span class="built_in">Node</span>(ll a = <span class="number">-1</span>, ll b = <span class="number">-1</span>, ll c = <span class="number">0</span>) &#123;</span><br><span class="line">        l = a, r = b, val = c;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> Node&amp; a) <span class="type">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> l &lt; a.l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">set&lt;Node&gt;s;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp</span><span class="params">(pair&lt;ll, ll&gt;x, pair&lt;ll, ll&gt;y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.first &lt; y.first;</span><br><span class="line">&#125;</span><br><span class="line">set&lt;Node&gt;::<span class="function">iterator <span class="title">split</span><span class="params">(ll pos)</span> </span>&#123;</span><br><span class="line">    set&lt;Node&gt;::iterator it = s.<span class="built_in">lower_bound</span>(<span class="built_in">Node</span>(pos));</span><br><span class="line">    <span class="keyword">if</span> (it != s.<span class="built_in">end</span>() &amp;&amp; it-&gt;l == pos)<span class="keyword">return</span> it;</span><br><span class="line">    --it;</span><br><span class="line">    Node tmp = *it;</span><br><span class="line">    s.<span class="built_in">erase</span>(it);</span><br><span class="line">    s.<span class="built_in">insert</span>(<span class="built_in">Node</span>(tmp.l, pos - <span class="number">1</span>, tmp.val));</span><br><span class="line">    <span class="keyword">return</span> s.<span class="built_in">insert</span>(<span class="built_in">Node</span>(pos, tmp.r, tmp.val)).first;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">assign</span><span class="params">(ll l, ll r, ll val)</span> </span>&#123;</span><br><span class="line">    set&lt;Node&gt;::iterator itr = <span class="built_in">split</span>(r + <span class="number">1</span>), itl = <span class="built_in">split</span>(l);</span><br><span class="line">    s.<span class="built_in">erase</span>(itl, itr);</span><br><span class="line">    s.<span class="built_in">insert</span>(<span class="built_in">Node</span>(l, r, val));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a, ll x, ll y)</span> </span>&#123;</span><br><span class="line">    ll ans = <span class="number">1</span>;</span><br><span class="line">    a %= y;</span><br><span class="line">    <span class="keyword">while</span> (x) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x &amp; <span class="number">1</span>)ans = (ans * a) % y;</span><br><span class="line">        a = (a * a) % y;</span><br><span class="line">        x &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line">ll e_2;</span><br><span class="line"><span class="function">ll <span class="title">query</span><span class="params">(ll l, ll r, ll d)</span> </span>&#123;</span><br><span class="line">    set&lt;Node&gt;::iterator itr = <span class="built_in">split</span>(r + <span class="number">1</span>), itl = <span class="built_in">split</span>(l);</span><br><span class="line">    ll ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (set&lt;Node&gt;::iterator it = itl; it != itr; it++) &#123;</span><br><span class="line">        ll L = it-&gt;l, R = it-&gt;r, lst = it-&gt;val;</span><br><span class="line">        ll sum = (L % MOD + R % MOD) % MOD * ((R - L + <span class="number">1</span>) % MOD) % MOD * e_2 % MOD;</span><br><span class="line">        ans = (ans + (d % MOD - lst) % MOD * sum % MOD) % MOD;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (ans + MOD) % MOD;</span><br><span class="line">&#125;</span><br><span class="line">ll n, q, d, l, r;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    e_2 = <span class="built_in">qpow</span>(<span class="number">2</span>, MOD - <span class="number">2</span>, MOD);</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; q;</span><br><span class="line">    s.<span class="built_in">insert</span>(<span class="built_in">Node</span>(<span class="number">1</span>, n, <span class="number">0</span>));</span><br><span class="line">    <span class="keyword">while</span> (q--) &#123;</span><br><span class="line">        cin &gt;&gt; d &gt;&gt; l &gt;&gt; r;</span><br><span class="line">        cout &lt;&lt; <span class="built_in">query</span>(l, r, d) &lt;&lt; endl;</span><br><span class="line">        <span class="built_in">assign</span>(l, r, d);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    ios::<span class="built_in">sync_with_stdio</span>(<span class="number">0</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    T_ = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (case_ = <span class="number">1</span>;case_ &lt;= T_;case_++)<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>赛后难度出来了，果然 G&gt;Ex 呢 &#x2F;hx</p>
</div></article></div><div class="card"><div class="card-image"><a class="image is-7by3" href="/2023/01/06/2022-7-15%E6%A8%A1%E6%8B%9F%E8%B5%9B%E8%AE%B0/"><img class="fill" src="https://pic.imgdb.cn/item/63b38badbe43e0d30e42fd21.jpg" alt="2022/7/15模拟赛记"></a></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2023-01-06T13:13:00.667Z" title="2023/1/6 21:13:00">2023-01-06</time>发表</span><span class="level-item"><time dateTime="2023-01-06T13:20:30.767Z" title="2023/1/6 21:20:30">2023-01-06</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%AF%94%E8%B5%9B%E7%AC%94%E8%AE%B0/">比赛笔记</a></span><span class="level-item">9 分钟读完 (大约1362个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2023/01/06/2022-7-15%E6%A8%A1%E6%8B%9F%E8%B5%9B%E8%AE%B0/">2022/7/15模拟赛记</a></h1><div class="content"><p>ych 出的模拟赛。</p>
<p>&#x2F;bx &#x2F;bx &#x2F;bx</p>
<p>原题场 &#x2F;fn &#x2F;fn &#x2F;fn</p>
<h1 id="赛时"><a href="#赛时" class="headerlink" title="赛时"></a>赛时</h1><h2 id="T1-string"><a href="#T1-string" class="headerlink" title="T1 string"></a>T1 string</h2><p><img src="https://pic.imgdb.cn/item/62d2280ff54cd3f937513da1.jpg"></p>
<p>发现是 NOIP 原题，然而忘记自己做过了。</p>
<p>想了一会发现自己做过，但是 ych 这个【】居然卡常，1e6-&gt;3e6 &#x2F;oh</p>
<p>然而自己之前写的是 BIT，吸氧后 900+ms，感觉有点危险，写了个 $O(n\ln n+n\cdot 26)$ 的，感觉也许能过。</p>
<p>ych 啊 ych，既然已经加强数据范围了就不要出毒瘤数据了吧。</p>
<p>预估 100pts</p>
<h2 id="T2-work"><a href="#T2-work" class="headerlink" title="T2 work"></a>T2 work</h2><p>上午刚做过 <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4158">P4158 粉刷匠</a>，就只想着背包了。</p>
<p>然后就写了个背包，复杂度 $O(na^2nb^2n)$，感觉很危险，有可能能过。</p>
<p>预估 80pts</p>
<h2 id="T3-sort"><a href="#T3-sort" class="headerlink" title="T3 sort"></a>T3 sort</h2><p>一开始瞎推推出来个 _逆序对数+递归层数_，然而这玩意居然是能过样例的。</p>
<p>写了个暴力对拍下，发现错了，然后白兰去看 T4 了。</p>
<p>最后 30min 随便想了一个结论：每个点到最后面的比它小的点的距离之和，发现能过样例，和暴力拍拍也对的 &#x2F;xia</p>
<p>最后造了个 2000 个 1e9 的数据，发现输出 0，于是写了个特判原数组已经有序就输出 $n$。</p>
<p>用 BIT 实现的，复杂度 $O(n \log n)$，1e5 的数据应该轻松。</p>
<p>预估 100pts</p>
<h2 id="T4-magic"><a href="#T4-magic" class="headerlink" title="T4 magic"></a>T4 magic</h2><p>想到 mod 不能约分，直接放弃。</p>
<p>预估 0pts</p>
<p>总分预估 100+80+100+0&#x3D;280pts</p>
<hr>
<h1 id="赛后"><a href="#赛后" class="headerlink" title="赛后"></a>赛后</h1><p>T1 被卡 T 成 80pts，T2,3,4 发挥稳定</p>
<p>总分 80+80+100+0&#x3D;260pts</p>
<p>发现 T2 正解实际上要二分，有单谷性质 &#x2F;px</p>
<p>蓝 &#x2F;bx</p>
<p>T3 居然结论猜对了</p>
<p>T4 矩阵乘法，维护前缀后缀积，然而 ych 卡带 log 的线段树做法 &#x2F;baojin</p>
<hr>
<p>ych 没开 O2，重测</p>
<p>&#x2F;fn &#x2F;fn &#x2F;fn</p>
<p>吸氧后 T1 过了。</p>
<p>O2 &#x2F;qiang</p>
<p>总分 100+80+100+0&#x3D;280pts</p>
<hr>
<p>以下为第二天</p>
<p>gzy T3 被卡后发现我的也挂了</p>
<p>successful hack!</p>
<p>gzy &#x2F;bx</p>
<p>总分 100+80+90+0&#x3D;270pts</p>
<hr>
<p>T1 被 sanwei 卡成 96 分。</p>
<p>反正本来也过不了的。</p>
<p>总分 96+80+90+0&#x3D;266pts</p>
<p>sanwei &#x2F;bx</p>
<h1 id="Links"><a href="#Links" class="headerlink" title="Links"></a>Links</h1><p>贴下原题链接吧</p>
<ul>
<li>T1 string <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P7114">NOIP2020 字符串匹配</a></li>
<li>T2 work <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5813">WC2001 高性能计算机</a></li>
<li>T3 sort <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4372">USACO18OPEN Out of Sorts P</a></li>
<li>T4 magic <a target="_blank" rel="noopener" href="https://loj.ac/p/573">「LibreOJ NOI Round #2」单枪匹马</a></li>
</ul>
<p>打的太差就不贴代码了</p>
<p><img src="https://pic.imgdb.cn/item/62d22d9df54cd3f93758aad5.png"></p>
<p>另附 ych 写的题解，如果像我一样觉得出题人很可爱的可以不看</p>
<details> <summary>题解</summary>

<h2 id="A-string"><a href="#A-string" class="headerlink" title="A.string"></a>A.string</h2><h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><p>给定字符串 $S$，求把 $S$ 拆分为 $ABAB…ABC$ 这样的形式的方案数。</p>
<h3 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h3><p>考虑枚举 $AB$ 的长度，用 $Z$ 函数求出最多连续 $AB$ 作为前缀的数量。</p>
<p>考虑 $C$ 中出现奇数次的字母的个数，发现对于 $AB$ 长度固定时只有两种取值，和选的 $AB$ 个数有关。</p>
<p>其中一种取值是固定的，另一种在枚举长度时可以递推求得。</p>
<p>然后在 $AB$ 中选择一个 $A$ 就是选择一个前缀，这个前缀出现奇数次字母的个数比 $C$ 出现奇数次字母的个数少。</p>
<p>这个用 bit 维护就可以了，这样是 nlog26。</p>
<p>进一步分析发现，$C$ 另一种取值每次变化量最多为 1，因此就不需要bit，只需要根据他这一次的变化计算贡献。把前面的结果加以利用。</p>
<h2 id="B-work"><a href="#B-work" class="headerlink" title="B.work"></a>B.work</h2><p>每个人有四个参数，求解决na个A和nb个B的最小时间。</p>
<h3 id="做法-1"><a href="#做法-1" class="headerlink" title="做法"></a>做法</h3><p>对第 $i$ 个人，考虑预处理 $cost(x,y)$ 表示解决 $x$ 个 $A$ 和 $y$ 个 $B$ 的最小代价。</p>
<p>这一部分是 $O(nm^3)$ 的。</p>
<p>然后如果是 $dp(i,x,y)$ 表示前 $i$ 个人解决 $x$ 个 $A$ 和 $y$ 个 $B$，转移枚举 $i$ 选几个 $A$ 几个 $B$，是 $O(nm^4)$。可以获得80分。</p>
<p>考虑优化。</p>
<p>由于答案是所有人的 max，可以考虑二分。</p>
<p>$dp(i,j)$ 表示 $i$ 个人在限制内解决 $j$ 个 $A$ 最多选的 $B$ 的个数。</p>
<p>然后这样发现是不对的。</p>
<p>因为 $cost(x,y)$ 并不是单调的。但是单谷的。</p>
<p>考虑证明。在 $x$ 固定的时候 $y$ 增加使得答案更小，说明把 $B$ 插入 $A$，且为独立的一段。</p>
<p>然后 $B$ 能有效插入的次数显然是有限的。不能插了以后都不能插。</p>
<p>所以 $dp(i,j)$ 应该存一个区间。</p>
<p>判 $nb$ 是否在区间内。</p>
<h2 id="C-sort"><a href="#C-sort" class="headerlink" title="C.sort"></a>C.sort</h2><h3 id="题意-1"><a href="#题意-1" class="headerlink" title="题意"></a>题意</h3><p>自己看吧。</p>
<h3 id="做法-2"><a href="#做法-2" class="headerlink" title="做法"></a>做法</h3><p>观察到这个 $cnt$ 每次增加的时候会增加一个 $length(A)$。</p>
<p>数形结合，对长度为length(A)的序列 bubble_sort，统计答案，实际上相当于把这个贡献均摊到每个点上。</p>
<p>于是考虑对每个点分别计算贡献。</p>
<p>这个点会连续被排序直到前后两个位置都成为分界线。</p>
<p>于是计算每个位置成为分界线的时间。</p>
<p>冒泡排序是稳定排序，所以Ai相不相同并不重要，可以全部当成不同的做，用双关键字。</p>
<p>然后要把所有&lt;x的放到前面去。</p>
<p>考虑冒泡排序的本质，就是分为若干段，每一段进行一个循环左移。</p>
<p>这个线一定会被包含在某一段中，然后一段结束的位置由于已经是分界线，不存在应该往前的，所以发现所有应该往前放的都会往前一位。而且这一段的开头一定不会是应该放在前面的。若是应该放在前面的，则一整段都是，又根据分界线，前面也都是，个数就不对了。</p>
<p>每个点最开始一定会被排一下，所以要和1取个max。</p>
<h2 id="D-magic"><a href="#D-magic" class="headerlink" title="D.magic"></a>D.magic</h2><h3 id="题意-2"><a href="#题意-2" class="headerlink" title="题意"></a>题意</h3><p>自己看。</p>
<h3 id="做法-3"><a href="#做法-3" class="headerlink" title="做法"></a>做法</h3><p>先考虑暴力，$a+\frac x y&#x3D;\frac {ay+x} {y}$，然后结合的时候可能还要倒过来。</p>
<p>$x$ 和 $y$ 互质，所以那个 $ay+x$ 和 $y$ 也互质。</p>
<p>所以就不用考虑约分，直接模意义下也可以做。</p>
<p>然后你发现把分子分母上矩阵，就可以做了。</p>
<p>我把线段树维护卡了，直接前缀和，处理矩阵的逆元。</p>
</details>

<p>THE END</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="Your name"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Your name</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Your location</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">0</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/ppoffice" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">学习笔记</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E5%AD%A6/"><span class="level-start"><span class="level-item">数学</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%AF%94%E8%B5%9B%E7%AC%94%E8%AE%B0/"><span class="level-start"><span class="level-item">比赛笔记</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E9%A2%98%E8%A7%A3/"><span class="level-start"><span class="level-item">题解</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-06T13:13:00.697Z">2023-01-06</time></p><p class="title"><a href="/2023/01/06/%E6%96%AF%E6%B6%85%E5%B0%94%E5%AE%9A%E5%BE%8B%E6%9C%80%E6%84%9A%E8%A0%A2%E7%9A%84%E8%AF%81%E6%B3%95/">斯涅尔定律最愚蠢的证法</a></p><p class="categories"><a href="/categories/%E6%95%B0%E5%AD%A6/">数学</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-06T13:13:00.697Z">2023-01-06</time></p><p class="title"><a href="/2023/01/06/%E7%99%BE%E5%BA%A6%E4%B9%8B%E6%98%9F2022%E5%88%9D%E8%B5%9B%E6%B8%B8%E8%AE%B0/">百度之星2022初赛游记</a></p><p class="categories"><a href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-06T13:13:00.695Z">2023-01-06</time></p><p class="title"><a href="/2023/01/06/%E4%B8%80%E4%BA%9B%20trick/">一些 trick</a></p><p class="categories"><a href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-06T13:13:00.692Z">2023-01-06</time></p><p class="title"><a href="/2023/01/06/UVA1063-Marble-Game/">UVA1063 Marble Game</a></p><p class="categories"><a href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-01-06T13:13:00.682Z">2023-01-06</time></p><p class="title"><a href="/2023/01/06/POJ1874-Trade-on-Verweggistan/">POJ1874 Trade on Verweggistan</a></p><p class="categories"><a href="/categories/%E9%A2%98%E8%A7%A3/">题解</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2023/01/"><span class="level-start"><span class="level-item">一月 2023</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Reflective-FG&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2023 Reflective-FG</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>